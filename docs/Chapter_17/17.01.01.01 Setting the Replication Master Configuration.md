#  17.1.1.1设置复制主配置

## 17.1.1.1设置复制主配置

在复制主站上，必须启用二进制日志记录并建立唯一的服务器ID。如果尚未执行此操作，则需要重新启动服务器。

主节点上的二进制的日志必须启动，因为二进制的日志是从节点检测变化的基础。如果未使用该log-bin选项启用二进制日志记录，则无法进行复制。

复制组中的每个服务器必须配置唯一的服务器ID。此ID用于标识组中的各个服务器，并且必须是1和（2 32）-1 之间的正整数。如何组织和选择数字是您的选择。

要配置二进制日志和服务器ID选项，请关闭MySQL服务器并编辑my.cnf或 my.ini文件。在[mysqld]配置文件的 部分中，添加log-bin和 server-id选项。如果这些选项已存在，但已注释掉，请取消注释选项并根据需要更改它们。例如，要使用日志文件名前缀启用二进制日志记录 mysql-bin，并将服务器ID配置为1，请使用以下行：

```
[mysqld]
log-bin = mysql-bin
server-id = 1
```
进行更改后，重新启动服务器。

> 注意  
> 如果省略server-id（或明确地将其设置为其默认值0），主机拒绝来自从机的任何连接。

> 注意  
> 为了在使用事务的复制设置中实现最大可能的持久性和一致性InnoDB，应在主 文件中使用 innodb_flush_log_at_trx_commit=1和 。 sync_binlog=1my.cnf

> 注意  
> 确保skip-networking 在复制主机上未启用该选项。如果网络已禁用，则从设备无法与主设备通信，并且复制失败。

