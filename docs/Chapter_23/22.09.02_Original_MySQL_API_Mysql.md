# 22.9.2. Original MySQL API (Mysql)

### 22.9.2. Original MySQL API (Mysql)

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

该扩展从 PHP 5.5.0 开始弃用了，不推荐在新的程序中使用该扩展因为该扩展以后会被移除。相反，应该使用 [mysqli][22.09.03] 或者 [PDO_MYSQL][22.09.04] 扩展，也可以查看 [MySQL API 概述][22.09.01.03]部分获取更多选择API的帮助信息。


这些函数允许你来访问MySQL数据库，更多MySQL的信息见 http://www.mysql.com/.

MySQL文档见[http://dev.mysql.com/doc/](http://dev.mysql.com/doc/).

#### 22.9.2.1. 安装/配置

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

##### 22.9.2.1.1. 需求

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

为了使用这些函数，在编译PHP的时候需要指定MySQL。

##### 22.9.2.1.2. 安装

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

编译时，只需简单的使用 --with-mysql[=DIR] 选项，[DIR] 指的是MySQL安装目录。

尽管该扩展兼容 MySQL 4.1.0 及之后的版本，但是它不支持这些版本提供的其它功能，所以使用 [mysqli][22.09.03] 扩展。

如果既想安装 mysql 扩展又想安装 mysqli 扩展，则必须使用相同的客户端库以避免冲突。

###### 22.9.2.1.2.1. 在Linux系统安装

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

注意： [DIR] 是 MySQL 客户端库文件（*headers and libraries*）的路径，可以在MySQL官网下载。

**Table 22.37. ext/mysql compile time support matrix**

<table summary="ext/mysql compile time support matrix" border="0">
    <thead>
        <tr>
            <th scope="col">
                PHP Version
            </th>
            <th scope="col">
                Default
            </th>
            <th scope="col">
                Configure Options: mysqlnd
            </th>
            <th scope="col">
                Configure Options:
               
                    libmysqlclient
                
            </th>
            <th scope="col">
                Changelog
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td scope="row">
                4.x.x
            </td>
            <td>
                libmysqlclient
            </td>
            <td>
                Not Available
            </td>
            <td>
               
                    --without-mysql
               
                to disable
            </td>
            <td>
                MySQL enabled by default, MySQL client libraries are bundled
            </td>
        </tr>
        <tr>
            <td scope="row">
                5.0.x, 5.1.x, 5.2.x
            </td>
            <td>
                libmysqlclient
            </td>
            <td>
                Not Available
            </td>
            <td>
                
                    --with-mysql=[DIR]
                
            </td>
            <td>
                MySQL is no longer enabled by default, and the MySQL client libraries
                are
                <a class="ulink" href="http://www.php.net/manual/en/faq.databases.php#faq.databases.mysql.php5"
                target="_top">
                    no longer bundled
                </a>
            </td>
        </tr>
        <tr>
            <td scope="row">
                5.3.x
            </td>
            <td>
                libmysqlclient
            </td>
            <td>
                
                    --with-mysql=mysqlnd
                
            </td>
            <td>
               
                    --with-mysql=[DIR]
                
            </td>
            <td>
                mysqlnd is now available
            </td>
        </tr>
        <tr>
            <td scope="row">
                5.4.x
            </td>
            <td>
                mysqlnd
            </td>
            <td>
                
                    --with-mysql
                
            </td>
            <td>
                
                    --with-mysql=[DIR]
                
            </td>
            <td>
                mysqlnd is now the default
            </td>
        </tr>
    </tbody>
</table>

###### 22.9.2.1.2.2. 在 Windows系统上安装

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

###### 22.9.2.1.2.2.1. PHP 4

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

 MySQL扩展默认被编译到PHP中

###### 22.9.2.1.2.2.2. PHP 5.0.x, 5.1.x, 5.2.x

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

默认情况下没有开启MySQL扩展，因此必须在 php.ini 中开启 php_mysql.dll，同时，PHP需要访问MySQL客户端库，在Windowx PHP发布版本里包含一个用于与MySQL 交互的文件 libmysql.dll，该文件需要在 Windows 系统路径中找到，更多信息详见FAQ [“怎样在Windows下添加PHP路径到系统PATH”](http://www.php.net/manual/en/faq.installation.php#faq.installation.addtopath)，尽管将 libmysql.dll 复制到Windows系统目录下也可以(因为系统目录是默认的系统PATH)，但是不推荐这么做。

只要开启任何一个php扩展(比如说 php_mysql.dll) ，php的指令 [extension_dir](http://www.php.net/manual/en/ini.core.php#ini.extension-dir) 都需要设置为扩展所在的目录，参见 [Windows安装手册](http://cn2.php.net/manual/en/install.windows.manual.php)，php5 在Window下扩展的目录的例子是 c:\php\ext 。

>**注意**    
>如果启动Web服务器的时候出现类似 “Unable to load dynamic library './php\_mysql.dll' ” 这样的问题，这是因为在系统找不到php\_mysql.dll 或者 libmysql.dll


###### 22.9.2.1.2.2.3. PHP 5.3.0+

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

包括 php_mysql.dll 在内默认都使用的是 [MySQL Native Driver][22.09.05.01]库， 因此不需要也不使用库 `libmysql.dll` 了。

###### 22.9.2.1.2.3. MySQL Installation Notes

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

>**警告**    
>可能会遇到PHP的崩溃和启动问题，当加载这些扩展的时候连同 recode扩展，更多信息详见[recode](http://cn2.php.net/manual/en/ref.recode.php)扩展。          

>**注意**    
>如果使用 *latin*(默认) 之外的字符集，则需要安装外部(不是绑定)的支持已编译字符集的 libmysqlclient.


##### 22.9.2.1.3. 运行时配置

Copyright 1997-2012 the PHP Documentation Group

这些功能的作用需要在 php.ini 中设置。

**Table 22.38. MySQL配置选项**

<table summary="MySQL Configuration Options" border="0">
    <thead>
        <tr>
            <th scope="col">
                Name
            </th>
            <th scope="col">
                Default
            </th>
            <th scope="col">
                Changeable
            </th>
            <th scope="col">
                Changelog
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td scope="row">
                <a class="link" href="apis-php-mysql.setup.html#apis-php-ini.mysql.allow-local-infile">
                    mysql.allow_local_infile
                </a>
            </td>
            <td>
                "1"
            </td>
            <td>
                PHP_INI_SYSTEM
            </td>
            <td>
                &nbsp;
            </td>
        </tr>
        <tr>
            <td scope="row">
                <a class="link" href="apis-php-mysql.setup.html#apis-php-ini.mysql.allow-persistent">
                    mysql.allow_persistent
                </a>
            </td>
            <td>
                "1"
            </td>
            <td>
                PHP_INI_SYSTEM
            </td>
            <td>
                &nbsp;
            </td>
        </tr>
        <tr>
            <td scope="row">
                <a class="link" href="apis-php-mysql.setup.html#apis-php-ini.mysql.max-persistent">
                    mysql.max_persistent
                </a>
            </td>
            <td>
                "-1"
            </td>
            <td>
                PHP_INI_SYSTEM
            </td>
            <td>
                &nbsp;
            </td>
        </tr>
        <tr>
            <td scope="row">
                <a class="link" href="apis-php-mysql.setup.html#apis-php-ini.mysql.max-links">
                    mysql.max_links
                </a>
            </td>
            <td>
                "-1"
            </td>
            <td>
                PHP_INI_SYSTEM
            </td>
            <td>
                &nbsp;
            </td>
        </tr>
        <tr>
            <td scope="row">
                <a class="link" href="apis-php-mysql.setup.html#apis-php-ini.mysql.trace-mode">
                    mysql.trace_mode
                </a>
            </td>
            <td>
                "0"
            </td>
            <td>
                PHP_INI_ALL
            </td>
            <td>
                Available since PHP 4.3.0.
            </td>
        </tr>
        <tr>
            <td scope="row">
                <a class="link" href="apis-php-mysql.setup.html#apis-php-ini.mysql.default-port">
                    mysql.default_port
                </a>
            </td>
            <td>
                NULL
            </td>
            <td>
                PHP_INI_ALL
            </td>
            <td>
                &nbsp;
            </td>
        </tr>
        <tr>
            <td scope="row">
                <a class="link" href="apis-php-mysql.setup.html#apis-php-ini.mysql.default-socket">
                    mysql.default_socket
                </a>
            </td>
            <td>
                NULL
            </td>
            <td>
                PHP_INI_ALL
            </td>
            <td>
                Available since PHP 4.0.1.
            </td>
        </tr>
        <tr>
            <td scope="row">
                <a class="link" href="apis-php-mysql.setup.html#apis-php-ini.mysql.default-host">
                    mysql.default_host
                </a>
            </td>
            <td>
                NULL
            </td>
            <td>
                PHP_INI_ALL
            </td>
            <td>
                &nbsp;
            </td>
        </tr>
        <tr>
            <td scope="row">
                <a class="link" href="apis-php-mysql.setup.html#apis-php-ini.mysql.default-user">
                    mysql.default_user
                </a>
            </td>
            <td>
                NULL
            </td>
            <td>
                PHP_INI_ALL
            </td>
            <td>
                &nbsp;
            </td>
        </tr>
        <tr>
            <td scope="row">
                <a class="link" href="apis-php-mysql.setup.html#apis-php-ini.mysql.default-password">
                    mysql.default_password
                </a>
            </td>
            <td>
                NULL
            </td>
            <td>
                PHP_INI_ALL
            </td>
            <td>
                &nbsp;
            </td>
        </tr>
        <tr>
            <td scope="row">
                <a class="link" href="apis-php-mysql.setup.html#apis-php-ini.mysql.connect-timeout">
                    mysql.connect_timeout
                </a>
            </td>
            <td>
                "60"
            </td>
            <td>
                PHP_INI_ALL
            </td>
            <td>
                PHP_INI_SYSTEM in PHP &lt;= 4.3.2. Available since PHP 4.3.0.
            </td>
        </tr>
    </tbody>
</table>


更多详细的信息及 PHP_INI_*模式的定义，详见 [http://www.php.net/manual/en/configuration.changes.modes](http://www.php.net/manual/en/configuration.changes.modes) 。

如下是这些配置的简单解释：

*mysql.allow_local_infile* integer   
	
从PHP的角度来讲，允许使用 LOAD DATA 语句访问本地文件

*mysql.allow_persistent* boolean    

是否允许到MySQL的 [持久连接](http://www.php.net/manual/en/features.persistent-connections)

*mysql.max_persistent* integer    

每个进程允许的最大MySQL持久连接数

*mysql.max_links* integer    

每个进程运行的最大MySQL连接数，包括持久连接

*mysql.trace_mode* boolean    

跟踪(trace)模式，当开启 mysql.trace_mode 的时候，表/索引 扫描时的警告信息、没有释放结果集和SQL错误将会显示出来(在PHP 4.3.0引进的)

*mysql.default_port* string    

连接到数据库服务器所用的默认TCP端口号如果没有指定端口号的话。如果没有指定默认的端口号，则将会从 MYSQL\_TCP_PORT 环境变量中获取， 按顺序来自在 /etc/services 中的  mysql-tcp 或者是编译时时 MYSQL\_PORT 常量，在Win32下只使用 MYSQL_PORT 常量。

*mysql.default_socket* string    

连接到本地数据库服务器时所用的默认socket，如果没有指定其它的socket

*mysql.default_host* string    

连接到数据库服务器所用的默认主机名，如果没有指定其它的host，不要在 [SQL safe mode](http://www.php.net/manual/en/ini.core.php#ini.sql.safe-mode) 模式下使用

*mysql.default_user* string    

连接到数据库服务器所用的默认用户名，如果没有指定其它的用户名，不要在 [SQL safe mode](http://www.php.net/manual/en/ini.core.php#ini.sql.safe-mode) 模式下使用

*mysql.default_password* string    

连接到数据库服务器所用的默认密码，如果没有指定其它的密码，不要在 [SQL safe mode](http://www.php.net/manual/en/ini.core.php#ini.sql.safe-mode) 模式下使用

*mysql.connect_timeout* integer    

连接超时时间，以秒计算，在Linux系统上，该时间也是等待服务器第一次响应的时间

##### 22.9.2.1.4. 资源类型

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

在MySQL module中有2种资源类型，一种是用于数据库连接的连接标识符(link identifier)，另一种是保存查询结果集的资源(resource)。


#### 22.9.2.2. 变更日志

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

下述的变更已经作用于扩展的 classes/functions/methods.

**ext/mysql 扩展大体上的变更**

参考 ext/mysql 扩展的变更日志

**已存在函数的变更**

下面的列表是 ext/mysql 函数的变更日志

**全部的 ext/mysql 变更**

下面的是整个 ext/mysql 扩展的变更列表:

<table summary="Unknown PHP API feature." border="0">
    <thead>
        <tr>
            <th scope="col">
                Version
            </th>
            <th scope="col">
                Description
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td scope="row">
                5.5.0
            </td>
            <td>
             该扩展已经弃用了，使用 mysql_connect、mysql_pconnect 连接MySQL数据库或者使用其它 mysql_* 函数的隐式连接都将产生 E_DEPRECATED 错误
            </td>
        </tr>
        <tr>
            <td scope="row">
                5.5.0
            </td>
            <td>
                 所有已弃用的函数和别名现在会产生 E_DEPRECATED 错误，这些函数包括:
                <p>
                    mysql(), mysql_fieldname(), mysql_fieldtable(), mysql_fieldlen(), mysql_fieldtype(),
                    mysql_fieldflags(), mysql_selectdb(), mysql_createdb(), mysql_dropdb(),
                    mysql_freeresult(), mysql_numfields(), mysql_numrows(), mysql_listdbs(),
                    mysql_listtables(), mysql_listfields(), mysql_db_name(), mysql_dbname(),
                    mysql_tablename(), and mysql_table_name().
                </p>
            </td>
        </tr>
    </tbody>
</table>

#### 22.9.2.3. 预定义常量

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

下面所列常量由扩展定义的，仅在扩展被编译进PHP或运行时动态加载时才有效。

从PHP4.3.0开始， mysql\_connect 和 mysql\_pconnect 函数可以使用额外的客户端标志(client flag)。常量列表如下：

**Table 22.39. MySQL client constants**

<table summary="MySQL client constants" border="0">
    <thead>
        <tr>
            <th scope="col">
                Constant
            </th>
            <th scope="col">
                Description
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td scope="row">
               
                    MYSQL_CLIENT_COMPRESS
                
            </td>
            <td>
                Use compression protocol
            </td>
        </tr>
        <tr>
            <td scope="row">
               
                    MYSQL_CLIENT_IGNORE_SPACE
                
            </td>
            <td>
                Allow space after function names
            </td>
        </tr>
        <tr>
            <td scope="row">
                
                    MYSQL_CLIENT_INTERACTIVE
                
            </td>
            <td>
                Allow interactive_timeout seconds (instead of
                
                    wait_timeout
                
                ) of inactivity before closing the connection.
            </td>
        </tr>
        <tr>
            <td scope="row">
                
                    MYSQL_CLIENT_SSL
                
            </td>
            <td>
                Use SSL encryption. This flag is only available with version 4.x of the
                MySQL client library or newer. Version 3.23.x is bundled both with PHP
                4 and Windows binaries of PHP 5.
            </td>
        </tr>
    </tbody>
</table>

函数 mysql\_fetch\_array 使用一个常量来标志不同类型的结果数组，常量定义如下：

**Table 22.40. MySQL fetch constants**

<table summary="MySQL fetch constants" border="0">
    <thead>
        <tr>
            <th scope="col">
                Constant
            </th>
            <th scope="col">
                Description
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td scope="row">
                MYSQL_ASSOC
            </td>
            <td>
                Columns are returned into the array having the fieldname as the array
                index.
            </td>
        </tr>
        <tr>
            <td scope="row">
                MYSQL_BOTH
            </td>
            <td>
                Columns are returned into the array having both a numerical index and
                the fieldname as the array index.
            </td>
        </tr>
        <tr>
            <td scope="row">
                MYSQL_NUM
            </td>
            <td>
                Columns are returned into the array having a numerical index to the fields.
                This index starts with 0, the first field in the result.
            </td>
        </tr>
    </tbody>
</table>


#### 22.9.2.4.例子

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

##### 22.9.2.4.1. MySQL extension overview example

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

这个简单的例子展示了怎样连接、执行查询、输出结果集及断开和MySQL服务器的连接。

**Example 22.22. MySQL extension overview example**

```php

<?php
// Connecting, selecting database
$link = mysql_connect('mysql_host', 'mysql_user', 'mysql_password')
    or die('Could not connect: ' . mysql_error());
echo 'Connected successfully';
mysql_select_db('my_database') or die('Could not select database');

// Performing SQL query
$query = 'SELECT * FROM my_table';
$result = mysql_query($query) or die('Query failed: ' . mysql_error());

// Printing results in HTML
echo "<table>\n";
while ($line = mysql_fetch_array($result, MYSQL_ASSOC)) {
    echo "\t<tr>\n";
    foreach ($line as $col_value) {
        echo "\t\t<td>$col_value</td>\n";
    }
    echo "\t</tr>\n";
}
echo "</table>\n";

// Free resultset
mysql_free_result($result);

// Closing connection
mysql_close($link);
?>

```

#### 22.9.2.5. MySQL Functions

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

>**注意**    
>大部分的MySQL函数接受一个可选的 *link_identifier* 作为最后一个参数，如果没有提供，则使用最近的一个连接，如果不存在连接，则使用 php.ini 中定义的参数试图建立连接，如果连接失败，则返回FALSE。

##### 22.9.2.5.1. mysql\_affected\_rows

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql\_affected\_rows

获取最近一次MySQL操作受影响的行数    
>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
                <a>
                   mysqli_affected_rows
                </a>
            </td>
        </tr>
        <tr>
            <td>
                <a>
                	PDOStatement::rowCount
                </a>
            </td>
        </tr>
    </tbody>
</table>

***描述***

`int mysql\_affected\_rows(resource link\_identifier= =NULL)`

 获取资源描述符 link_identifier 最近一次 INSERT, UPDATE, REPLACE 或者 DELETE 操作受影响的行数。

***参数***

*link_identifier*

MySQL连接标识符，如果没有指定， 则使用由 mysql_connect 创建的最后一个连接，如果不存在，则试图创建一个连接，就好像调用了 mysql_connect 但没有指定参数。如果不能创建连接，则产生一个 E_WARNING 级别的错误。

***返回值***

若成功则返回受影响的行数，失败返回-1。

如果最近一次的MySQL操作是 DELETE 操作并且没有 WHERE 条件，则会删除表中所有的记录，但是在MySQL 4.1.2 版本之前会返回0。

当执行 UPDATE 操作，MySQL不更新新值与原来的值相等的列，可能会导致 mysql_affected_rows 返回值和实际发生变更的行数不相等，仅返回了表面上受影响的行数。

REPLACE 操作首选删掉有相同主键的记录然后插入新记录，该函数返回删除记录的行数与插入记录的行数的和。

在执行 “INSERT ... ON DUPLICATE KEY UPDATE” 操作时，如果执行insert操作则返回1，如果执行更update作则返回2。

***Examples***

**Example 22.23. mysql\_affected\_rows example**

```php

<?php
$link = mysql_connect('localhost', 'mysql_user', 'mysql_password');
if (!$link) {
    die('Could not connect: ' . mysql_error());
}
mysql_select_db('mydb');

/* this should return the correct numbers of deleted records */
mysql_query('DELETE FROM mytable WHERE id < 10');
printf("Records deleted: %d\n", mysql_affected_rows());

/* with a where clause that is never true, it should return 0 */
mysql_query('DELETE FROM mytable WHERE 0');
printf("Records deleted: %d\n", mysql_affected_rows());
?>

```

上面例子的输出将类似于：

Records deleted: 10   
Records deleted: 0

**Example 22.24. mysql\_affected\_rows example using transactions**

```php

<?php
$link = mysql_connect('localhost', 'mysql_user', 'mysql_password');
if (!$link) {
    die('Could not connect: ' . mysql_error());
}
mysql_select_db('mydb');

/* Update records */
mysql_query("UPDATE mytable SET used=1 WHERE id < 10");
printf ("Updated records: %d\n", mysql_affected_rows());
mysql_query("COMMIT");
?>

```
上面例子的输出将类似于：

Updated Records: 10

**注意事项**

> **事务**
> 如果使用事务，则需要在 INSERT, UPDATE, 或者 DELETE 语句之后调用 mysql_affected_rows ，而不是在 COMMIT 语句之后
> **SELECT 语句**
> 如果想获取 SELECT 操作返回的行数，则应该使用 mysql_num_rows
> **级联外键**
> mysql_affected_rows 不统计使用 ON DELETE CASCADE 和/或者 ON UPDATE CASCADE 语句在外键约束情况下隐式影响的行

***参考：***
<table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
                mysql_num_rows
            </td>
        </tr>
        <tr>
            <td>
               mysql_info
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.2. mysql_client_encoding

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_client_encoding

返回字符集的名字

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：  
>mysqli\_character\_set\_name

***描述***

`string mysql_client_encoding(resource link_identifier= =NULL)`

返回 MySQL的 character_set 变量。

***参数***

*link_identifier*

MySQL连接标识符，如果没有指定， 则使用由 mysql_connect 创建的最后一个连接，如果不存在，则试图创建一个连接，就好像调用了 mysql_connect 但没有指定参数。如果不能创建连接，则产生一个 E_WARNING 级别的错误。

***返回值***

返回当前连接的默认字符集

***例子***

**Example 22.25. mysql_client_encoding example**

```php

<?php
$link    = mysql_connect('localhost', 'mysql_user', 'mysql_password');
$charset = mysql_client_encoding($link);

echo "The current character set is: $charset\n";
?>

```

上面例子的输出结果类似于：

```shll
The current character set is: latin1
```

***参考***

<table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
                <a>
                    mysql_set_charset
                </a>
            </td>
        </tr>
        <tr>
            <td>
                <a>
                    mysql_real_escape_string
                </a>
            </td>
        </tr>
    </tbody>
</table>

###### 22.9.2.5.3. mysql_close

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_close

关闭 MySQ L连接

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：  
><table xmlns="" border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
                <a>
                    mysqli_close
                </a>
            </td>
        </tr>
        <tr>
            <td>
                PDO: Assign the value of NULL to the PDO object
            </td>
        </tr>
    </tbody>
</table>

***描述***

`bool mysql_close(resource link_identifier= =NULL)`

mysql_close 关闭指定连接描述符的与MySQL服务器的非持久连接，如果没有指定 *link_identifier*，则使用最后的一个连接。

通常情况下不需要使用 mysql_close ，因为非持久连接在脚本执行结束后自动关闭，参见 [释放资源](http://www.php.net/manual/en/language.types.resource.php#language.types.resource.self-destruct).

***参数***

*link_identifier*

MySQL连接标识符，如果没有指定， 则使用由 mysql_connect 创建的最后一个连接，如果不存在，则试图创建一个连接，就好像调用了 mysql_connect 但没有指定参数。如果不能创建连接，则产生一个 E_WARNING 级别的错误。

***返回值***

成功返回 TRUE 失败返回 FALSE

***例子***

**Example 22.26. mysql_close example**

```php

<?php
$link = mysql_connect('localhost', 'mysql_user', 'mysql_password');
if (!$link) {
    die('Could not connect: ' . mysql_error());
}
echo 'Connected successfully';
mysql_close($link);
?>

```

上面列子输出如下：

Connected successfully

***注意事项***

>**注意**
>mysql_close 不能关闭由 mysql_pconnect 创建的持久连接

***参见***

<table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
                <a>
                    mysql_connect
                </a>
            </td>
        </tr>
        <tr>
            <td>
                <a>
                  mysql_free_result
                </a>
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.4. mysql_connect

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_connect

建立到 MySQL 服务器的连接

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：  
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
                <a>
                    mysqli_connect
                </a>
            </td>
        </tr>
        <tr>
            <td>
                <a>
                  PDO::__construct
                </a>
            </td>
        </tr>
    </tbody>
</table>

***描述***

```php
resource mysql_connect(string server= =ini_get("mysql.default_host"),
                       string username= =ini_get("mysql.default_user"),
                       string password= =ini_get("mysql.default_password"),
                       bool new_link= =false,
                       int client_flags= =0);
```

新建或者重新使用一个到MySQL的连接

***参数***

*server*

MySQL 服务器，可以包含一个端口号，例如 “hostname:port”，或者也可以是本地socket路径，如 “:/path/to/socket”。

如果没有定义 mysql.default_host，则默认的值是 'localhost:3306'，在 [ SQL safe mode](http://www.php.net/manual/en/ini.core.php#ini.sql.safe-mode) 模式下，将忽略该参数并且总使用值 'localhost:3306' 。

*username*

用户名，默认的值由 mysql.default_user 定义，在 [SQL safe mode](http://www.php.net/manual/en/ini.core.php#ini.sql.safe-mode) 模式下，该将忽略该参数，使用拥有该进程(server process)的用户。

*password*

密码，默认密码由 mysql.default_password 定义，在 [SQL safe mode](http://www.php.net/manual/en/ini.core.php#ini.sql.safe-mode) 模式下，将忽略该参数，使用空密码。

*new_link*

如果使用相同的参数再次调用 mysql_connect ，则不会创建新的连接，会返回已创建的连接标识符。参数 *new_link* 改变了这种行为，即使之前已经使用相同的参数调用过了mysql_connect，但也仍然建立一个新的连接，在 [SQL safe mode](http://www.php.net/manual/en/ini.core.php#ini.sql.safe-mode) 模式下，将忽略该参数。

*client_flags*

参数 *client\_flags* 的值可以使下述各常量的组合：128(运行执行 LOAD DATA LOCAL),MYSQL\_CLIENT\_SSL , MYSQL\_CLIENT\_COMPRESS , MYSQL\_CLIENT\_IGNORE\_SPACE 或者 MYSQL\_CLIENT\_INTERACTIVE，更多信息详见 [表22.39 "MySQL 客户端常量"][22.09.02.03]，在 [SQL safe mode](http://www.php.net/manual/en/ini.core.php#ini.sql.safe-mode) 模式下，将忽略该参数。

***返回值***

成功返回MySQL连接标识符，失败返回false

***变更日志***

<table summary="Changelog information for this function" border="0">
    <thead>
        <tr>
            <th scope="col">
                Version
            </th>
            <th scope="col">
                Description
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td scope="row">
                5.5.0
            </td>
            <td>
                This function will generate an E_DEPRECATED error.
            </td>
        </tr>
        <tr>
            <td scope="row">
                4.3.0
            </td>
            <td>
                Added the client_flags parameter.
            </td>
        </tr>
        <tr>
            <td scope="row">
                4.2.0
            </td>
            <td>
                Added the new_link parameter.
            </td>
        </tr>
    </tbody>
</table>

***例子***

**Example 22.27. mysql_connect example**

```php

<?php
$link = mysql_connect('localhost', 'mysql_user', 'mysql_password');
if (!$link) {
    die('Could not connect: ' . mysql_error());
}
echo 'Connected successfully';
mysql_close($link);
?>

```

Example 22.28. mysql_connect example using hostname:port syntax

```php

<?php
// we connect to example.com and port 3307
$link = mysql_connect('example.com:3307', 'mysql_user', 'mysql_password');
if (!$link) {
    die('Could not connect: ' . mysql_error());
}
echo 'Connected successfully';
mysql_close($link);

// we connect to localhost at port 3307
$link = mysql_connect('127.0.0.1:3307', 'mysql_user', 'mysql_password');
if (!$link) {
    die('Could not connect: ' . mysql_error());
}
echo 'Connected successfully';
mysql_close($link);
?>

```

Example 22.29. mysql_connect example using ":/path/to/socket" syntax

```

<?php
// we connect to localhost and socket e.g. /tmp/mysql.sock

// variant 1: omit localhost
$link = mysql_connect(':/tmp/mysql', 'mysql_user', 'mysql_password');
if (!$link) {
    die('Could not connect: ' . mysql_error());
}
echo 'Connected successfully';
mysql_close($link);


// variant 2: with localhost
$link = mysql_connect('localhost:/tmp/mysql.sock', 'mysql_user', 'mysql_password');
if (!$link) {
    die('Could not connect: ' . mysql_error());
}
echo 'Connected successfully';
mysql_close($link);
?>

```

***注意事项***

>**注意**   
>无论将server指定为 "localhost" 还是 "localhost:port" ，MySQL客户端库(client library)总是会覆盖它们并且尽力连接到本地 socket(在Windows下是命名管道(named pipe))，如果想使用TCP/IP，则用 "127.0.0.1" 来代替 "localhost"。如果MySQL客户端库连接到一个错误的本地 socket，则需要在PHP的配置文件中设置正确的 `mysql.default_host string` 路径然后将server字段留白。


>**注意**    
>直到脚本执行结束后，到服务器的连接才会被关闭，除非显式调用 mysql_close 来提早关闭连接

>**注意**    
>通过在函数名前面加一个 @ 符号，可以抑制失败情况下错误信息输出


>**注意**     
>错误信息 "Can't create TCP/IP socket (10106)" 通常意味着配置指令 [variables_order](http://www.php.net/manual/en/ini.core.php#ini.variables-orde) 不包含字符 E 。在 Windows系统，如果没有复制环境，环境变量 SYSTEMROOT 不可用，并且PHP在加载Winsock时候会出现问题。

***参考***

<table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
                 mysql_pconnect
            </td>
        </tr>
        <tr>
            <td>
               mysql_close
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.5. mysql\_create\_db

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_create_db

创建一个MySQL数据库

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
                mysqli_query
            </td>
        </tr>
        <tr>
            <td>
               PDO::query
            </td>
        </tr>
    </tbody>
</table> 

***描述***

`bool mysql_create_db(string database_name, resource link_identifier= =NULL)`

mysql_create_db 试图在指定连接标识符的服务器上创建一个新数据库。

***参数***

*database_name*

要创建的数据库的名字

*link_identifier*

MySQL连接标识符，如果没有指定， 则使用由 mysql_connect 创建的最后一个连接，如果不存在，则试图创建一个连接，就好像调用了 mysql_connect 但没有指定参数。如果不能创建连接，则产生一个 E_WARNING 级别的错误。

***返回值***

成功返回 TRUE，失败返回 FALSE

***例子***

Example 22.30. mysql_create_db alternative example

函数 mysql_create_db 已经被弃用了，最好使用 mysql_query 来执行一个 CREATE DATABASE 语句

```php

<?php
$link = mysql_connect('localhost', 'mysql_user', 'mysql_password');
if (!$link) {
    die('Could not connect: ' . mysql_error());
}

$sql = 'CREATE DATABASE my_db';
if (mysql_query($sql, $link)) {
    echo "Database my_db created successfully\n";
} else {
    echo 'Error creating database: ' . mysql_error() . "\n";
}
?>

```

上面列子的输出类似于：

Database my_db created successfully

***注意事项***

>注意    
>为了向后兼容，以弃用的别名 mysql_createdb 可以使用

>注意    
>如果MySQL扩展使用的了MySQL 4.x版本，则该函数不可用


***参考***

<table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
               mysql_query
            </td>
        </tr>
        <tr>
            <td>
               mysql_select_db
            </td>
        </tr>
    </tbody>
</table> 

##### 22.9.2.5.6. mysql_data_seek

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_data_seek

移动内部结果集指针

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
                mysqli_data_seek
            </td>
        </tr>
        <tr>
            <td>
               PDO::FETCH_ORI_ABS
            </td>
        </tr>
    </tbody>
</table> 

***描述***

`bool mysql_data_seek(resource result, int row_number)`

mysql_data_seek 移动MySQL结果集的内部行指针，然后调用一个MySQL fetch函数，例如：mysql_fetch_assoc 会返回该行

*row_number* 以0开始，应该在0 和 mysql_num_rows -1 之间的一个值，然而，如果结果集是空的( mysql_num_rows=0)，则seek到0的操作会失败并生成一个 E_WARNING 级别错误， mysql_data_seek 返回FALSE。

***参数***

*result*

正在被评估的结果集 resource，它来源于一个 mysql_query 调用

*row_number*

希望的新结果集指针的行号

***返回值***

成功返回TRUE，失败返回FALSE

***例子***

Example 22.31. mysql_data_seek example

```php

<?php
$link = mysql_connect('localhost', 'mysql_user', 'mysql_password');
if (!$link) {
    die('Could not connect: ' . mysql_error());
}
$db_selected = mysql_select_db('sample_db');
if (!$db_selected) {
    die('Could not select database: ' . mysql_error());
}
$query = 'SELECT last_name, first_name FROM friends';
$result = mysql_query($query);
if (!$result) {
    die('Query failed: ' . mysql_error());
}
/* fetch rows in reverse order */
for ($i = mysql_num_rows($result) - 1; $i >= 0; $i--) {
    if (!mysql_data_seek($result, $i)) {
        echo "Cannot seek to row $i: " . mysql_error() . "\n";
        continue;
    }

    if (!($row = mysql_fetch_assoc($result))) {
        continue;
    }

    echo $row['last_name'] . ' ' . $row['first_name'] . "<br />\n";
}

mysql_free_result($result);
?>

```

***注意事项***

>注意    
> mysql_data_seek 仅可以和函数 mysql_query 一起使用，不可以和 mysql_unbuffered_query 一起使用

***参见***
<table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
               mysql_query
            </td>
        </tr>
        <tr>
            <td>
              mysql_num_rows
            </td>
        </tr>
		<tr>
            <td>
                mysql_fetch_row
            </td>
        </tr>
        <tr>
            <td>
               mysql_fetch_assoc
            </td>
        </tr>
		<tr>
            <td>
               mysql_fetch_array
            </td>
        </tr>
		<tr>
            <td>
               mysql_fetch_object
            </td>
        </tr>
    </tbody>
</table> 

##### 22.9.2.5.7. mysql_db_name

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_db_name

从调用 mysql_list_dbs 中获取数据库的名字

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
                Query: SELECT DATABASE()
            </td>
        </tr>
    </tbody>
</table> 

***描述***

`string mysql_db_name(resource result,int row,mixed field= =NULL)`

从调用 mysql_list_dbs 中获取数据库的名字

***参数***

*result*

来自调用 mysql_list_dbs 返回的结果集指针

*row*

在结果集中的索引

*field*

字段名称

***返回值***

成功返回数据库的名字，失败返回FALSE，如果返回FALSE，使用 mysql_error 来查看错误信息

***变更日志***

<table summary="Changelog information for this function" border="0">
    <thead>
        <tr>
            <th scope="col">
                Version
            </th>
            <th scope="col">
                Description
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td scope="row">
                5.5.0
            </td>
            <td>
                函数 mysql_list_dbs 已经废弃了，会发出一个 E_DEPRECATED 级别的错误
            </td>
        </tr>
    </tbody>
</table>

***例子***

Example 22.32. mysql_db_name example

```php

<?php
error_reporting(E_ALL);

$link = mysql_connect('dbhost', 'username', 'password');
$db_list = mysql_list_dbs($link);

$i = 0;
$cnt = mysql_num_rows($db_list);
while ($i < $cnt) {
    echo mysql_db_name($db_list, $i) . "\n";
    $i++;
}
?>

```

***注意事项***

>**注意**    
>为了向后兼容，已弃用的别名  mysql_dbname 可以使用

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
                mysql_list_dbs
            </td>
        </tr>
		<tr>
            <td>
                mysql_tablename
            </td>
        </tr>
    </tbody>
</table> 

##### 22.9.2.5.8. mysql_db_query

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_db_query

选择一个数据库并且在该数据库执行查询

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_select_db then the query
            </td>
        </tr>
		<tr>
            <td>
				PDO::__construct
            </td>
        </tr>
    </tbody>
</table>

***描述***

`resource mysql_db_query(string database, string query,resource link_identifier= =NULL)`

mysql_db_query 选择一个数据库，然后在该数据库上执行一个查询

>警告    
>该函数从 PHP5.3.0 开始弃用了，非常不鼓励使用该函数

***参数***

*database*

将要选择的数据库的名字

*query*

MySQL查询    
查询所用到的数据应该适当转义

*link_identifier*

MySQL连接标识符，如果没有指定， 则使用由 mysql_connect 创建的最后一个连接，如果不存在，则试图创建一个连接，就好像调用了 mysql_connect 但没有指定参数。如果不能创建连接，则产生一个 E_WARNING 级别的错误。

***返回值***

成功返回一个正数表示MySQL查询结果资源标识符，失败返回FALSE，该函数对于 INSERT/UPDATE/DELETE 查询也返回 TRUE/FALSE 表示成功/失败

***变更日志***

<table summary="Changelog information for this function" border="0">
    <thead>
        <tr>
            <th scope="col">
                Version
            </th>
            <th scope="col">
                Description
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td scope="row">
                5.3.0
            </td>
            <td>
                This function now throws an E_DEPRECATED notice.
            </td>
        </tr>
        <tr>
            <td scope="row">
                4.0.6
            </td>
            <td>
				该函数已经弃用了，不要使用该函数，使用  mysql_select_db 和 mysql_query 来代替
            </td>
        </tr>
    </tbody>
</table>

***例子***

Example 22.33. mysql_db_query alternative example

```php

<?php

if (!$link = mysql_connect('mysql_host', 'mysql_user', 'mysql_password')) {
    echo 'Could not connect to mysql';
    exit;
}

if (!mysql_select_db('mysql_dbname', $link)) {
    echo 'Could not select database';
    exit;
}

$sql    = 'SELECT foo FROM bar WHERE id = 42';
$result = mysql_query($sql, $link);

if (!$result) {
    echo "DB Error, could not query the database\n";
    echo 'MySQL Error: ' . mysql_error();
    exit;
}

while ($row = mysql_fetch_assoc($result)) {
    echo $row['foo'];
}

mysql_free_result($result);

?>

```

***注意事项***

>**注意**    
>该函数不切换回你之前连接的那个数据库，换句话说，你不能暂时的在另一个数据库上执行查询，你必须手动的切换回来，强烈建议用户在查询中使用 database.table 语法或者是使用函数 mysql_select_db 。

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_query
            </td>
        </tr>
		<tr>
            <td>
               mysql_select_db
            </td>
        </tr>
    </tbody>
</table> 


##### 22.9.2.5.9. mysql_drop_db

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_drop_db

删除一个MySQL书库

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
>执行 DROP DATABASE query

***描述***

`bool mysql_drop_db(string database_name, resource link_identifier= =NULL)`

mysql_drop_db 尝试从服务器上删除整个数据库，该函数已经弃用了，最好使用  mysql_query 来执行一个 DROP DATABASE 语句。

***参数***

*database_name*

将要删除的数据库的名字

*link_identifier*

MySQL连接标识符，如果没有指定， 则使用由 mysql_connect 创建的最后一个连接，如果不存在，则试图创建一个连接，就好像调用了 mysql_connect 但没有指定参数。如果不能创建连接，则产生一个 E_WARNING 级别的错误。

***返回值***

成功返回TRUE，失败返回FALSE

***例子***

Example 22.34. mysql_drop_db alternative example

```php

<?php
$link = mysql_connect('localhost', 'mysql_user', 'mysql_password');
if (!$link) {
    die('Could not connect: ' . mysql_error());
}

$sql = 'DROP DATABASE my_db';
if (mysql_query($sql, $link)) {
    echo "Database my_db was successfully dropped\n";
} else {
    echo 'Error dropping database: ' . mysql_error() . "\n";
}
?>

```

***注意事项***

>**警告**    
>如果MySQL扩展使用的是MySQL 4.x 版本的客户端库则该函数不可用

>**注意**    
>为了向后兼容，已废弃的别名  mysql_dropdb 可以使用

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_query
            </td>
        </tr>
    </tbody>
</table> 

##### 22.9.2.5.10. mysql_errno

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_errno

返回前一个MySQL操作错误信息对应的数字码

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_errno
            </td>
        </tr>
		<tr>
            <td>
				PDO::errorCode
            </td>
        </tr>
    </tbody>
</table>

***描述***

`int mysql_errno(resource link_identifier= =NULL)`

返回上一个MySQL函数的错误码

来自MySQL后端的错误将不再发出警告信息，相反，使用  mysql_errno 来获取错误码，注意，该函数仅返回最近一次执行的MySQL函数(不包括mysql_error 和 mysql_errno)的错误码，因此如果想使用它，确保在调用下一个MySQL函数前检测该错误码。

***参数***

*link_identifier*

MySQL连接标识符，如果没有指定， 则使用由 mysql_connect 创建的最后一个连接，如果不存在，则试图创建一个连接，就好像调用了 mysql_connect 但没有指定参数。如果不能创建连接，则产生一个 E_WARNING 级别的错误。

***返回值***

返回上一个MySQL操作的错误码，如果没有错误返回0

***例子***

Example 22.35. mysql_errno example

```php

<?php
$link = mysql_connect("localhost", "mysql_user", "mysql_password");

if (!mysql_select_db("nonexistentdb", $link)) {
    echo mysql_errno($link) . ": " . mysql_error($link). "\n";
}

mysql_select_db("kossu", $link);
if (!mysql_query("SELECT * FROM nonexistenttable", $link)) {
    echo mysql_errno($link) . ": " . mysql_error($link) . "\n";
}
?>

```

上面例子的输出类似于：

1049: Unknown database 'nonexistentdb'
1146: Table 'kossu.nonexistenttable' doesn't exist

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_error
            </td>
        </tr>
		 <tr>
            <td>
				MySQL error codes
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.11. mysql_error

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_error

返回前一个MySQL操作错误信息对应的文本信息

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_error
            </td>
        </tr>
		<tr>
            <td>
				PDO::errorInfo
            </td>
        </tr>
    </tbody>
</table>

***描述***

`string mysql_error(resource link_identifier= =NULL)`

返回上一个MySQL函数的错误文本信息，来自MySQL后端的错误将不再发出警告信息，相反，使用 mysql_error 获取错误文本信息，注意，该函数仅返回最近一次执行的MySQL函数(不包括 mysql_error 和 mysql_errno) 的错误文本信息，因此如果想使用它，确保在调用下一个MySQL函数前检测该错误信息。

***参数***

*link_identifier*

MySQL连接标识符，如果没有指定， 则使用由 mysql_connect 创建的最后一个连接，如果不存在，则试图创建一个连接，就好像调用了 mysql_connect 但没有指定参数。如果不能创建连接，则产生一个 E_WARNING 级别的错误。

***返回值***

返回上一个MySQL函数的错误文本信息，如果没有错误发生，返回''(空字符)

***例子***

Example 22.36. mysql_error example

```php

<?php
$link = mysql_connect("localhost", "mysql_user", "mysql_password");

mysql_select_db("nonexistentdb", $link);
echo mysql_errno($link) . ": " . mysql_error($link). "\n";

mysql_select_db("kossu", $link);
mysql_query("SELECT * FROM nonexistenttable", $link);
echo mysql_errno($link) . ": " . mysql_error($link) . "\n";
?>

```

上面列子的输出将类似于：

1049: Unknown database 'nonexistentdb'
1146: Table 'kossu.nonexistenttable' doesn't exist

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_errno
            </td>
        </tr>
		 <tr>
            <td>
				MySQL error codes
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.12. mysql_escape_string

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_escape_string

转义在 mysql_query 中所用字符串

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_escape_string
            </td>
        </tr>
		<tr>
            <td>
				PDO::quote
            </td>
        </tr>
    </tbody>
</table>

***描述***

`string mysql_escape_string(string unescaped_string)`

该函数用来转义未转义的字符串，以使它在 mysql_query 中是安全的，该函数已经弃用了

该函数同 mysql_real_escape_string 是相同的，但是 mysql_real_escape_string 多了一个连接标识符参数并且根据当前的字符集设置来转义字符，而 mysql_escape_string 没有连接标识符参数并且不遵守当前字符集设置。

>警告    
>该函数从PHP5.3.0开始已经弃用了，非常不推荐使用该函数

***参数***

*unescaped_string*

将要转义的字符串

***返回值***

返回转义后的字符串

***变更日志***

<table summary="Changelog information for this function" border="0">
    <thead>
        <tr>
            <th scope="col">
                Version
            </th>
            <th scope="col">
                Description
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td scope="row">
                5.3.0
            </td>
            <td>
                函数抛出 notice 级别的 E_DEPRECATED 信息
            </td>
        </tr>
        <tr>
            <td scope="row">
                4.3.0
            </td>
            <td>
               该函数已经弃用了，不要使用该函数，使用 mysql_real_escape_string 来代替
            </td>
        </tr>
    </tbody>
</table>  

***例子***

Example 22.37. mysql_escape_string example

```php

<?php
$item = "Zak's Laptop";
$escaped_item = mysql_escape_string($item);
printf("Escaped string: %s\n", $escaped_item);
?>

```

上面的例子将会输出：

Escaped string: Zak\'s Laptop

***注意事项***

>**注意**    
>mysql_escape_string 不转义 % 和 _

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_real_escape_string
            </td>
        </tr>
		 <tr>
            <td>
				addslashes
            </td>
        </tr>
		<tr>
            <td>
				 magic_quotes_gpc 指令
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.13. mysql_fetch_array

Copyright 1997-2012 the PHP Documentation Group

* mysql_fetch_array

以关联数组或者是数值数值或者2者皆有的形式获取结果集的一行

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_fetch_array
            </td>
        </tr>
		<tr>
            <td>
				PDOStatement::fetch
            </td>
        </tr>
    </tbody>
</table>

***描述***

`array mysql_fetch_array(resource result,int result_type= =MYSQL_BOTH)`

返回获取到的一行数组，并且向前移动内部指针

***参数***

*result*

结果集的资源标识符，结果来自于对 mysql_query 的调用

*result_type*

返回的数组类型，它是一个常量，取值可以是 MYSQL_ASSOC , MYSQL_NUM , 和 MYSQL_BOTH 

***返回值***

成功返回获取行的数组，如果没有行了则返回FALSE，返回数组的类型依赖于 result_type 的定义，如果是 MYSQL_BOTH(默认)，则会返回关联索引数组和数值索引数组；如果指定 MYSQL_ASSOC，只返回关联索引数组（类似于调用 mysql_fetch_assoc)；如果指定 MYSQL_NUM ，仅返回数字索引数组(类似于调用了 mysql_fetch_row)。

如果结果集中有超过2列有相同的键名，最后一列会覆盖掉前面的，如果想访问同键名的其它列，必须使用列的数值索引或者是给该列定义一个别名，对于别名列，不可以使用原来的列明来访问其内容。

***例子***

Example 22.38. Query with aliased duplicate field names

```sql

SELECT table1.field AS foo, table2.field AS bar FROM table1, table2

```

Example 22.39. mysql_fetch_array with MYSQL_NUM

```php

<?php
mysql_connect("localhost", "mysql_user", "mysql_password") or
    die("Could not connect: " . mysql_error());
mysql_select_db("mydb");

$result = mysql_query("SELECT id, name FROM mytable");

while ($row = mysql_fetch_array($result, MYSQL_NUM)) {
    printf("ID: %s  Name: %s", $row[0], $row[1]);  
}

mysql_free_result($result);
?>

```

Example 22.40. mysql_fetch_array with MYSQL_ASSOC

```php

<?php
mysql_connect("localhost", "mysql_user", "mysql_password") or
    die("Could not connect: " . mysql_error());
mysql_select_db("mydb");

$result = mysql_query("SELECT id, name FROM mytable");

while ($row = mysql_fetch_array($result, MYSQL_ASSOC)) {
    printf("ID: %s  Name: %s", $row["id"], $row["name"]);
}

mysql_free_result($result);
?>

```

Example 22.41. mysql_fetch_array with MYSQL_BOTH

```php

<?php
mysql_connect("localhost", "mysql_user", "mysql_password") or
    die("Could not connect: " . mysql_error());
mysql_select_db("mydb");

$result = mysql_query("SELECT id, name FROM mytable");

while ($row = mysql_fetch_array($result, MYSQL_BOTH)) {
    printf ("ID: %s  Name: %s", $row[0], $row["name"]);
}

mysql_free_result($result);
?>

```

***注意事项***

>**性能**    
>需要注意的是，使用 mysql_fetch_array 并不是比 mysql_fetch_row 非常慢，然而却提供了一个重要的附加值

>**注意**     
>该函数返回的键值是大小写敏感的

>**注意**    
>该函数将PHP的NULL值的键值设置成NULL

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_fetch_row
            </td>
        </tr>
		 <tr>
            <td>
				mysql_fetch_assoc
            </td>
        </tr>
		<tr>
            <td>
				 mysql_data_seek
            </td>
        </tr>
		<tr>
            <td>
				 mysql_query
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.14. mysql_fetch_assoc

Copyright 1997-2012 the PHP Documentation Group

* mysql_fetch_asso

以关联数组的形式返回结果

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_fetch_assoc
            </td>
        </tr>
		<tr>
            <td>
				PDOStatement::fetch(PDO::FETCH_ASSOC)
            </td>
        </tr>
    </tbody>
</table>

***描述***

`array mysql_fetch_assoc(resource result)`

返回关联数组并向前移动指针，调用 mysql_fetch_assoc 等于调用 mysql_fetch_array 将第二个参数设置成 MYSQL_ASSOC，它仅返回一个关联数组。

***参数***

*result*

结果集的资源标识符，其值是来自对 mysql_query 的调用

***返回值***

返回所获取行的关联数组，如果没有行了则返回FALSE

如果结果集中有超过2列有相同的键名，最后一列会覆盖掉前面的，如果想访问同键名的其它列，必须使用列的数值索引或者是给该列定义一个别名，参见 mysql_fetch_array 中关于别名的列子。

***例子***

Example 22.42. An expanded mysql_fetch_assoc example

```php

<?php

$conn = mysql_connect("localhost", "mysql_user", "mysql_password");

if (!$conn) {
    echo "Unable to connect to DB: " . mysql_error();
    exit;
}

if (!mysql_select_db("mydbname")) {
    echo "Unable to select mydbname: " . mysql_error();
    exit;
}

$sql = "SELECT id as userid, fullname, userstatus
        FROM   sometable
        WHERE  userstatus = 1";

$result = mysql_query($sql);

if (!$result) {
    echo "Could not successfully run query ($sql) from DB: " . mysql_error();
    exit;
}

if (mysql_num_rows($result) == 0) {
    echo "No rows found, nothing to print so am exiting";
    exit;
}

// While a row of data exists, put that row in $row as an associative array
// Note: If you're expecting just one row, no need to use a loop
// Note: If you put extract($row); inside the following loop, you'll
//       then create $userid, $fullname, and $userstatus
while ($row = mysql_fetch_assoc($result)) {
    echo $row["userid"];
    echo $row["fullname"];
    echo $row["userstatus"];
}

mysql_free_result($result);

?>

```

***注意事项***

>**性能**     
>需要注意的是，使用 mysql_fetch_array 并不是比 mysql_fetch_row 非常慢，然而却提供了一个重要的附加值

>**注意**     
>该函数返回的键值是大小写敏感的

>**注意**    
>该函数将PHP的NULL值的键值设置成NULL

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_fetch_row
            </td>
        </tr>
		 <tr>
            <td>
				mysql_fetch_array
            </td>
        </tr>
		<tr>
            <td>
				 mysql_data_seek
            </td>
        </tr>
		<tr>
            <td>
				mysql_query
            </td>
        </tr>
		<tr>
            <td>
				mysql_error
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.15. mysql_fetch_field

Copyright 1997-2012 the PHP Documentation Group

* mysql_fetch_field

从结果集中获取列的信息并以对象的形式返回

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_fetch_field
            </td>
        </tr>
		<tr>
            <td>
				PDOStatement::getColumnMeta
            </td>
        </tr>
    </tbody>
</table>

***描述***

`object mysql_fetch_field(resource result, int field_offset= =0)`

返回一个包含列信息的对象，该函数可以用来获取结果集中列的信息。

***参数***

*result*

结果集资源标识符，该值来自于对 mysql_query 的调用

*field_offset*

列的偏移量，如果没有指定偏移量，则返回还未被该函数获取的下一个列， *field_offset* 从0开始

***返回值***

返回包含列信息的对象，对象的属性如下：    

* name - 列的名字
* table - 列所属的表的名字，如果定义别名则是别名
* max_length - 列最大长度
* not_null - 如果列不可以是NULL，则该值是1
* primary_key - 如果该列是主键，则该值是1
* unique_key - 如果该列是唯一索引，则该值是1
* multiple_key - 如果该列是非唯一索引，则该值是1
* numeric - 如果该列是数值型，则该值是1
* blob - 如果该列数据类型为BLOB，则该值是1
* type - 列的类型
* unsigned - 如果该列是unsigned，则该值为1
* zerofill - 如果该列是 zero-filled，则该值是1

***例子***

Example 22.43. mysql_fetch_field example

```php

<?php
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password');
if (!$conn) {
    die('Could not connect: ' . mysql_error());
}
mysql_select_db('database');
$result = mysql_query('select * from table');
if (!$result) {
    die('Query failed: ' . mysql_error());
}
/* get column metadata */
$i = 0;
while ($i < mysql_num_fields($result)) {
    echo "Information for column $i:<br />\n";
    $meta = mysql_fetch_field($result, $i);
    if (!$meta) {
        echo "No information available<br />\n";
    }
    echo "<pre>
blob:         $meta->blob
max_length:   $meta->max_length
multiple_key: $meta->multiple_key
name:         $meta->name
not_null:     $meta->not_null
numeric:      $meta->numeric
primary_key:  $meta->primary_key
table:        $meta->table
type:         $meta->type
unique_key:   $meta->unique_key
unsigned:     $meta->unsigned
zerofill:     $meta->zerofill
</pre>";
    $i++;
}
mysql_free_result($result);
?>

```

***注意事项***

>**注意**    
>该函数返回的字段名是大小写敏感的

>**注意**     
>如果字段名或表明在 SQL 查询中使用了别名，将会返回别名，原始的名字可以通过例如 mysqli_result::fetch_field 来返回

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_field_seek
            </td>
        </tr>
	</tbody>
</table>

##### 22.9.2.5.16. mysql_fetch_lengths

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_fetch_lengths

返回结果集每个输出的长度

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_fetch_lengths
            </td>
        </tr>
		<tr>
            <td>
				PDOStatement::getColumnMeta
            </td>
        </tr>
    </tbody>
</table>

***描述***

`array mysql_fetch_lengths(resource result)`

返回最近获取的一行中每行的长度，以数组形式返回

mysql_fetch_lengths 存储由  mysql_fetch_row, mysql_fetch_assoc, mysql_fetch_array, 和 mysql_fetch_object 返回的最后一行每列的长度，以数组形式返回，从0开始。

***参数***

*result*

结果集资源标识符，该值来自对　mysql_query 的调用

***返回值***

成功返回长度数组，失败返回FALSE

***例子***

Example 22.44. A mysql_fetch_lengths example

```php

<?php
$result = mysql_query("SELECT id,email FROM people WHERE id = '42'");
if (!$result) {
    echo 'Could not run query: ' . mysql_error();
    exit;
}
$row     = mysql_fetch_assoc($result);
$lengths = mysql_fetch_lengths($result);

print_r($row);
print_r($lengths);
?>

```

上面列子的输出将类似于：

```
Array
(
    [id] => 42
    [email] => user@example.com
)
Array
(
    [0] => 2
    [1] => 16
)
```

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_field_len
            </td>
        </tr>
		 <tr>
            <td>
				mysql_fetch_row
            </td>
        </tr>
		<tr>
            <td>
				 strlen
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.17. mysql_fetch_object

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_fetch_object

以对象形式获取一行结果

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_fetch_object
            </td>
        </tr>
		<tr>
            <td>
				PDOStatement::fetch(PDO::FETCH_OBJ)
            </td>
        </tr>
    </tbody>
</table>

***描述***

`object mysql_fetch_object(resource result,string class_name,array params)`

返回一个对象，属性是所获取行的信息，然后向前移动数据指针

***参数***

*result*

结果集资源标识符， 该值来自对 mysql_query 的调用

*class_name*

将要实例化的类的名字，设置其属性然后返回，如果没有指定，则返回 stdClass 类对象

*params*

一个可选的 array 参数，传递个 *class_name* 的构造函数

***返回值***

返回一个对象，属性为对应的行，如果没有更多的行则返回FALSE

***变更日志***

<table summary="Changelog information for this function" border="0">
    <thead>
        <tr>
            <th scope="col">
                Version
            </th>
            <th scope="col">
                Description
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td scope="row">
                5.0.0
            </td>
            <td>
                增加返回不同对象的功能
            </td>
        </tr>
    </tbody>
</table>

***例子***

Example 22.45. mysql_fetch_object example

```php

<?php
mysql_connect("hostname", "user", "password");
mysql_select_db("mydb");
$result = mysql_query("select * from mytable");
while ($row = mysql_fetch_object($result)) {
    echo $row->user_id;
    echo $row->fullname;
}
mysql_free_result($result);
?>

```

Example 22.46. mysql_fetch_object example

```php

<?php
class foo {
    public $name;
}

mysql_connect("hostname", "user", "password");
mysql_select_db("mydb");

$result = mysql_query("select name from mytable limit 1");
$obj = mysql_fetch_object($result, 'foo');
var_dump($obj);
?>

```

***注意事项***

>**性能**     
>速度好，该函数和 mysql_fetch_array 一样，但是几乎和 mysql_fetch_row(区别不大) 一样快

>**注意**
>mysql_fetch_object 类似于 mysql_fetch_array ，不同处是前者返回一个对象，后者返回一个数组，也就意味着只可以使用字段名来访问数据，不可以通过偏移量来访问(数字是不合法的属性名)

>**注意**     
>该函数返回的字段名是大小写敏感的

>**注意**      
>该函数将PHP 的NULL值设置NULL字段

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_fetch_array
            </td>
        </tr>
		 <tr>
            <td>
				mysql_fetch_assoc
            </td>
        </tr>
		<tr>
            <td>
				mysql_fetch_row
            </td>
        </tr>
		<tr>
            <td>
				mysql_data_seek
            </td>
        </tr>
		<tr>
            <td>
				mysql_query
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.18. mysql_fetch_row

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_fetch_row

以枚举数组形式返回一行结果

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_fetch_row
            </td>
        </tr>
		<tr>
            <td>
				PDOStatement::fetch(PDO::FETCH_NUM)
            </td>
        </tr>
    </tbody>
</table>

***描述***

`array mysql_fetch_row(resource result)`

以数值数组形式返回获取的一行数据并向前移动内部数据指针

***参数***

*result*

结果集资源标识符，来自于对　mysql_query 的调用

***返回值***

返回数值索引数组，包含所获取行的数据，如果没有数据了则返回FALSE

mysql_fetch_row 根据指定的结果集资源标识符获取一行数据，以数组的形式返回，每一列以偏移量形式存储，起始偏移量是0

***例子***

Example 22.47. Fetching one row with mysql_fetch_row

```php

<?php
$result = mysql_query("SELECT id,email FROM people WHERE id = '42'");
if (!$result) {
    echo 'Could not run query: ' . mysql_error();
    exit;
}
$row = mysql_fetch_row($result);

echo $row[0]; // 42
echo $row[1]; // the email value
?>

```

***注意事项***

>注意    
>对于PHP的NULL值，设置NULL字段

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_fetch_array
            </td>
        </tr>
		 <tr>
            <td>
				mysql_fetch_assoc
            </td>
        </tr>
		<tr>
            <td>
				mysql_fetch_object
            </td>
        </tr>
		<tr>
            <td>
				mysql_data_seek
            </td>
        </tr>
		<tr>
            <td>
				mysql_fetch_lengths
            </td>
        </tr>
		<tr>
            <td>
				mysql_result
            </td>
        </tr>
    </tbody>
</table>

###### 22.9.2.5.19. mysql_field_flags

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_field_flags

获取结果集中指定列的标识信息

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_fetch_field_direct [flags]
            </td>
        </tr>
		<tr>
            <td>
				PDOStatement::getColumnMeta [flags]
            </td>
        </tr>
    </tbody>
</table>

***描述***

`string mysql_field_flags(resource result,int field_offset)`

mysql_field_flags 返回指定列的列标识信息，每一个标识以单词的形式报告信息，所有标识以空格分开，可以使用函数 [explode](http://cn2.php.net/explode) 将返回结果劈开。

***描述***

*result*

结果集资源标识符，来自于对　mysql_query 的调用

*field_offset*

列偏移量， *field_offset* 从0开始，如果 *field_offset* 不存在，则报 E_WARNING 级别错误。

***返回值***

返回一个与结果相关的字符串，如果失败则返回false

如果你的MySQL版本支持，下列字符串会返回："not_null", "primary_key", "unique_key", "multiple_key", "blob", "unsigned", "zerofill", "binary", "enum", "auto_increment" and "timestamp".

***例子***

Example 22.48. A mysql_field_flags example

```php

<?php
$result = mysql_query("SELECT id,email FROM people WHERE id = '42'");
if (!$result) {
    echo 'Could not run query: ' . mysql_error();
    exit;
}
$flags = mysql_field_flags($result, 0);

echo $flags;
print_r(explode(' ', $flags));
?>

```

上面列子输出类似于：

```
not_null primary_key auto_increment
Array
(
    [0] => not_null
    [1] => primary_key
    [2] => auto_increment
)
```

***注意事项***

>**注意**    
>为了向后兼容，已弃用别名 mysql_fieldflags 可以使用

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_field_type
            </td>
        </tr>
		 <tr>
            <td>
				mysql_field_len
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.20. mysql_field_len

Copyright 1997-2012 the PHP Documentation Group

* mysql_field_len

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_fetch_field_direct [length]
            </td>
        </tr>
		<tr>
            <td>
				PDOStatement::getColumnMeta [len]
            </td>
        </tr>
    </tbody>
</table>

***描述***

`int mysql_field_len(resource result,int field_offset)`

mysql_field_len 返回指定列的长度

***参数***

*result*

结果集资源标识符，来自于对　mysql_query 的调用

*field_offset*

列偏移量， *field_offset* 从0开始，如果 *field_offset* 不存在，则报 E_WARNING 级别错误。

***返回值***

成功返回指定列的长度，失败返回FALSE

***例子***

Example 22.49. mysql_field_len example

```php

<?php
$result = mysql_query("SELECT id,email FROM people WHERE id = '42'");
if (!$result) {
    echo 'Could not run query: ' . mysql_error();
    exit;
}

// Will get the length of the id field as specified in the database
// schema. 
$length = mysql_field_len($result, 0);
echo $length;
?>

```
***注意事项***

>**注意**     
>为了向后兼容，以弃用别名  mysql_fieldlen 可以使用

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_fetch_lengths
            </td>
        </tr>
		 <tr>
            <td>
				strlen
            </td>
        </tr>
    </tbody>
</table>

###### 22.9.2.5.21. mysql_field_name

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_field_name

获取结果集中指定列的名字

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_fetch_field_direct [name] or [orgname]
            </td>
        </tr>
		<tr>
            <td>
				PDOStatement::getColumnMeta [name]
            </td>
        </tr>
    </tbody>
</table>

***描述***

`string mysql_field_name(resource result,int field_offset)`

mysql_field_name 获取结果集中指定列的名字.

***参数***

*result*

结果集资源标识符，来自于对　mysql_query 的调用

*field_offset*

列偏移量， *field_offset* 从0开始，如果 *field_offset* 不存在，则报 E_WARNING 级别错误。

***返回值***

成功返回指定列的名字，失败返回FALSE

***例子***

Example 22.50. mysql_field_name example

```php

<?php
/* The users table consists of three fields:
 *   user_id
 *   username
 *   password.
 */
$link = mysql_connect('localhost', 'mysql_user', 'mysql_password');
if (!$link) {
    die('Could not connect to MySQL server: ' . mysql_error());
}
$dbname = 'mydb';
$db_selected = mysql_select_db($dbname, $link);
if (!$db_selected) {
    die("Could not set $dbname: " . mysql_error());
}
$res = mysql_query('select * from users', $link);

echo mysql_field_name($res, 0) . "\n";
echo mysql_field_name($res, 2);
?>

```

上例输出类似于：

```
user_id
password
```

***注意事项***

>**注意**     
>该函数返回的字段名是大小写敏感的

>**注意**     
>为了向后兼容，已弃用别名 mysql_fieldname 可以使用

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_field_type
            </td>
        </tr>
		 <tr>
            <td>
				mysql_field_len
            </td>
        </tr>
    </tbody>
</table>

###### 22.9.2.5.22. mysql_field_seek

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_field_seek

将结果集的指针设置为指定的偏移量

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_field_seek
            </td>
        </tr>
		<tr>
            <td>
				PDOStatement::fetch using optional parameters
            </td>
        </tr>
    </tbody>
</table>

***描述***

`bool mysql_field_seek(resource result,int field_offset)`

移动结果集指针到指定偏移量，如果接下来调用函数 mysql_fetch_field 但是不包含偏移量，则返回 mysql_field_seek 中指定的偏移量。

***参数***

*result*

结果集资源标识符，来自于对　mysql_query 的调用

*field_offset*

列偏移量， *field_offset* 从0开始，如果 *field_offset* 不存在，则报 E_WARNING 级别错误。

***返回值***

成功返回TRUE，失败返回FALSE

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_fetch_field
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.23. mysql_field_table

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_field_table

获取指定列所在的表名

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_field_seek
            </td>
        </tr>
		<tr>
            <td>
				PDOStatement::fetch using optional parameters
            </td>
        </tr>
    </tbody>
</table>

***描述***

`string mysql_field_table(resource result, int field_offset)`

获取指定列所在的表名

***参数***

*result*

结果集资源标识符，来自于对　mysql_query 的调用

*field_offset*

列偏移量， *field_offset* 从0开始，如果 *field_offset* 不存在，则报 E_WARNING 级别错误。

***返回值***

成功返回表的名字

***例子***

Example 22.51. A mysql_field_table example

```php

<?php

$query = "SELECT account.*, country.* FROM account, country WHERE country.name = 'Portugal' AND account.country_id = country.id";

// get the result from the DB
$result = mysql_query($query);

// Lists the table name and then the field name
for ($i = 0; $i < mysql_num_fields($result); ++$i) {
    $table = mysql_field_table($result, $i);
    $field = mysql_field_name($result, $i);

    echo  "$table: $field\n";
}

?>

```

***注意事项***

>**注意**        
>为了向后兼容，已弃用别名 mysql_fieldtable 也可以使用

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_list_tables
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.24. mysql_field_type

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_field_type

返回结果集中指定列的类型

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_field_seek
            </td>
        </tr>
		<tr>
            <td>
				PDOStatement::fetch using optional parameters
            </td>
        </tr>
    </tbody>
</table>

***描述***

`string mysql_field_type(resource result, int field_offset)`

mysql_field_type 类似于函数 mysql_field_name ，参数是一样的，但是返回字段类型

***参数***

*result*

结果集资源标识符，来自于对　mysql_query 的调用

*field_offset*

列偏移量， *field_offset* 从0开始，如果 *field_offset* 不存在，则报 E_WARNING 级别错误。

***返回值***

返回的字段类型是 "int", "real", "string", "blob" 等中的一个，其它类型详见 [MySQL 文档](http://dev.mysql.com/doc/)

***列子***

Example 22.52. mysql_field_type example

```php

<?php
mysql_connect("localhost", "mysql_username", "mysql_password");
mysql_select_db("mysql");
$result = mysql_query("SELECT * FROM func");
$fields = mysql_num_fields($result);
$rows   = mysql_num_rows($result);
$table  = mysql_field_table($result, 0);
echo "Your '" . $table . "' table has " . $fields . " fields and " . $rows . " record(s)\n";
echo "The table has the following fields:\n";
for ($i=0; $i < $fields; $i++) {
    $type  = mysql_field_type($result, $i);
    $name  = mysql_field_name($result, $i);
    $len   = mysql_field_len($result, $i);
    $flags = mysql_field_flags($result, $i);
    echo $type . " " . $name . " " . $len . " " . $flags . "\n";
}
mysql_free_result($result);
mysql_close();
?>

```

上例的输出类似于：

```
Your 'func' table has 4 fields and 1 record(s)
The table has the following fields:
string name 64 not_null primary_key binary
int ret 1 not_null
string dl 128 not_null
string type 9 not_null enum
```

***注意事项***

>**注意**    
>为了向后兼容，已弃用别名 mysql_fieldtype 可以使用

***参考***
<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_field_name
            </td>
        </tr>
		<tr>
            <td>
				mysql_field_len
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.25. mysql_free_result

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_free_result

释放结果集所占内存

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_free_result
            </td>
        </tr>
		<tr>
            <td>
				Assign the value of NULL to the PDO object, or PDOStatement::closeCursor
            </td>
        </tr>
    </tbody>
</table>

***描述***

`bool mysql_free_result(resource result)`

mysql_free_result 释放所有和结果标识符 result 有关的内存。

当考虑到返回的结果集很大占用内存很多时，则才需要调用 mysql_free_result，在脚本结束后所有相关的内存都将自动释放。

***参数***

*result*

结果集资源标识符，来自于对　mysql_query 的调用

***返回值***

成功返回TRUE失败返回FALSE

如果参数 *result* 不是一个资源标志， 将会跑出一个 E_WARNING 级别的错误。值得注意的是，mysql_query 仅对 SELECT, SHOW, EXPLAIN, 和 DESCRIBE 查询返回一个 resource 资源标志。

***例子***

Example 22.53. A mysql_free_result example

```php

<?php
$result = mysql_query("SELECT id,email FROM people WHERE id = '42'");
if (!$result) {
    echo 'Could not run query: ' . mysql_error();
    exit;
}
/* Use the result, assuming we're done with it afterwards */
$row = mysql_fetch_assoc($result);

/* Now we free up the result and continue on with our script */
mysql_free_result($result);

echo $row['id'];
echo $row['email'];
?>

```

***注意事项***

>**注意**    
>为了向后兼容，已弃用别名 mysql_freeresult 可以使用

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_query
            </td>
        </tr>
		<tr>
            <td>
				is_resource
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.26. mysql_get_client_info

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_get_client_info

获取MySQL客户端信息

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_get_client_info
            </td>
        </tr>
		<tr>
            <td>
				PDO::getAttribute(PDO::ATTR_CLIENT_VERSION)
            </td>
        </tr>
    </tbody>
</table>

***描述***

`string mysql_get_client_info()`

mysql_get_client_info 返回一字符串，代表客户端库的版本号

***返回值***

MySQL客户端版本

***例子***

Example 22.54. mysql_get_client_info example

```php

<?php
printf("MySQL client info: %s\n", mysql_get_client_info());
?>

```

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_get_host_info
            </td>
        </tr>
		<tr>
            <td>
				mysql_get_proto_info
            </td>
        </tr>
		<tr>
            <td>
				mysql_get_server_info
            </td>
        </tr>
    </tbody>
</table>

###### 22.9.2.5.27. mysql_get_host_info

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_get_host_info

获取MySQL host 信息

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_get_host_info
            </td>
        </tr>
		<tr>
            <td>
				PDO::getAttribute(PDO::ATTR_CONNECTION_STATUS)
            </td>
        </tr>
    </tbody>
</table>

***描述***

`string mysql_get_host_info(resource link_identifier= =NULL)`

描述连接所用的连接类型，包括主机名

***参数***

*link_identifier*

MySQL连接标识符，如果没有指定， 则使用由 mysql_connect 创建的最后一个连接，如果不存在，则试图创建一个连接，就好像调用了 mysql_connect 但没有指定参数。如果不能创建连接，则产生一个 E_WARNING 级别的错误。

***返回值***

成功，返回MySQL连接所用的连接类型，失败返回FALSE

***例子***

Example 22.55. mysql_get_host_info example

```php

<?php
$link = mysql_connect('localhost', 'mysql_user', 'mysql_password');
if (!$link) {
    die('Could not connect: ' . mysql_error());
}
printf("MySQL host info: %s\n", mysql_get_host_info());
?>

```

上面例子的输出将类似于：

```
MySQL host info: Localhost via UNIX socket
```

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_get_client_info
            </td>
        </tr>
		<tr>
            <td>
				mysql_get_proto_info
            </td>
        </tr>
		<tr>
            <td>
				mysql_get_server_info
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.28. mysql_get_proto_info

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_get_proto_info

获取MySQL协议信息

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_get_proto_info
            </td>
        </tr>
    </tbody>
</table>

***描述***

`int mysql_get_proto_info(resource link_identifier= =NULL)`

获取MySQL协议

***参数***

*link_identifier*

MySQL连接标识符，如果没有指定， 则使用由 mysql_connect 创建的最后一个连接，如果不存在，则试图创建一个连接，就好像调用了 mysql_connect 但没有指定参数。如果不能创建连接，则产生一个 E_WARNING 级别的错误。

***返回值***

成功返回MySQL协议，失败返回FALSE

***例子***

Example 22.56. mysql_get_proto_info example

```php

<?php
$link = mysql_connect('localhost', 'mysql_user', 'mysql_password');
if (!$link) {
    die('Could not connect: ' . mysql_error());
}
printf("MySQL protocol version: %s\n", mysql_get_proto_info());
?>

```

上面列子的输出将类似于：

MySQL protocol version: 10

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_get_client_info
            </td>
        </tr>
		<tr>
            <td>
				mysql_get_host_info
            </td>
        </tr>
		<tr>
            <td>
				mysql_get_server_info
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.29. mysql_get_server_info

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_get_server_info

获取 MySQL server 信息

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_get_server_info
            </td>
        </tr>
		 <tr>
            <td>
				PDO::getAttribute(PDO::ATTR_SERVER_VERSION)
            </td>
        </tr>
    </tbody>
</table>

***描述***

`string mysql_get_server_info(resource link_identifier= =NULL)`

获取MySQL服务器的版本

***参数***

*link_identifier*

MySQL连接标识符，如果没有指定， 则使用由 mysql_connect 创建的最后一个连接，如果不存在，则试图创建一个连接，就好像调用了 mysql_connect 但没有指定参数。如果不能创建连接，则产生一个 E_WARNING 级别的错误。

***返回值***

成功返回MySQL服务器版本号，失败返回FALSE

***例子***

Example 22.57. mysql_get_server_info example

```php

<?php
$link = mysql_connect('localhost', 'mysql_user', 'mysql_password');
if (!$link) {
    die('Could not connect: ' . mysql_error());
}
printf("MySQL server version: %s\n", mysql_get_server_info());
?>

```

上面列子的输出类似于：

MySQL server version: 4.0.1-alpha

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_get_client_info
            </td>
        </tr>
		<tr>
            <td>
				mysql_get_host_info
            </td>
        </tr>
		<tr>
            <td>
				mysql_get_proto_info
            </td>
        </tr>
		<tr>
            <td>
				phpversion
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.30. mysql_info

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_info

获取最近查询的信息

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_info
            </td>
        </tr>
		 <tr>
            <td>
				PDO::getAttribute(PDO::ATTR_SERVER_VERSION)
            </td>
    </tbody>
</table>

***描述***

`string mysql_info(resource link_identifier= =NULL)`

获取最近一次查询的详细信息

***参数***

*link_identifier*

MySQL连接标识符，如果没有指定， 则使用由 mysql_connect 创建的最后一个连接，如果不存在，则试图创建一个连接，就好像调用了 mysql_connect 但没有指定参数。如果不能创建连接，则产生一个 E_WARNING 级别的错误。

***返回值***

成功返回语句信息，失败返回FALSE。看下面的例子，哪个语提句提供了信息及对应的返回值是什么样的，没有列出来的语句将返回FALSE

***例子***

**Example 22.58. Relevant MySQL Statements**

返回字符串值的语句，数字仅为了说明，它们的实际值和query相对应

```sql
INSERT INTO ... SELECT ...
String format: Records: 23 Duplicates: 0 Warnings: 0 
INSERT INTO ... VALUES (...),(...),(...)...
String format: Records: 37 Duplicates: 0 Warnings: 0 
LOAD DATA INFILE ...
String format: Records: 42 Deleted: 0 Skipped: 0 Warnings: 0 
ALTER TABLE
String format: Records: 60 Duplicates: 0 Warnings: 0 
UPDATE
String format: Rows matched: 65 Changed: 65 Warnings: 0
```

***注意事项***

>**注意**    
>mysql_info 对于 `INSERT ... VALUES` 语句仅在语句中列出多个值的情况下返回一个 非FALSE值

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_affected_rows
            </td>
        </tr>
		<tr>
            <td>
				mysql_insert_id
            </td>
        </tr>
		<tr>
            <td>
				mysql_stat
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.31. mysql_insert_id

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_insert_id

获取最后一个查询生成的ID

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_insert_id
            </td>
        </tr>
		 <tr>
            <td>
				PDO::lastInsertId
            </td>
		</tr>
    </tbody>
</table>

***描述***

`int mysql_insert_id(resource link_identifier= =NULL)`

获取上一个查询  AUTO_INCREMENT 列生成的ID(通常是INSERT)

***参数***

*link_identifier*

MySQL连接标识符，如果没有指定， 则使用由 mysql_connect 创建的最后一个连接，如果不存在，则试图创建一个连接，就好像调用了 mysql_connect 但没有指定参数。如果不能创建连接，则产生一个 E_WARNING 级别的错误。

***返回值***

成功，返回上一个查询 AUTO_INCREMENT 列生成的ID，如果查询没有生成一个 AUTO_INCREMENT 值，则返回0，如果没有MySQL连接则返回FALSE。

***例子***

**Example 22.59. mysql_insert_id example**

```php

<?php
$link = mysql_connect('localhost', 'mysql_user', 'mysql_password');
if (!$link) {
    die('Could not connect: ' . mysql_error());
}
mysql_select_db('mydb');

mysql_query("INSERT INTO mytable (product) values ('kossu')");
printf("Last inserted record has id %d\n", mysql_insert_id());
?>

```

***注意事项***

>**小心**    
>mysql_insert_id 会将 MySQL C API 函数 mysql_insert_id()的返回值类型转化成 long 类型(在PHP中为int)，如果  AUTO_INCREMENT 列是 bigint(64位) 类型的，这种转换可能会导致值发生错误，因此，在SQL查询中使用内部的 MySQL SQL函数LAST_INSERT_ID() 来代替，更多关于PHP整型最大值问题，详见 [integer](http://cn2.php.net/manual/en/language.types.integer.php) 文档。

>**注意**    
>因为 mysql_insert_id 作用于最后执行的查询，确保在查询生成值后立即调用函数 mysql_insert_id 

>**注意**    
>MySQL SQL 函数 LAST_INSERT_ID() 总是包含最近生成的 AUTO_INCREMENT 值，并且在查询直接不重新设置

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_query
            </td>
        </tr>
		<tr>
            <td>
				mysql_info
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.32. mysql_list_dbs

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_list_dbs

列出MySQL服务器上的数据库

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				SQL Query: SHOW DATABASES
            </td>
        </tr>
    </tbody>
</table>

***描述***

`resource mysql_list_dbs(resource link_identifier= =NULL)`

返回当前数据库服务器包含的数据库的结果集指针

>**警告**     
>该函数从PHP 5.4.0 开始已经弃用了，强烈不推荐依赖该函数

***参数***

*link_identifier*

MySQL连接标识符，如果没有指定， 则使用由 mysql_connect 创建的最后一个连接，如果不存在，则试图创建一个连接，就好像调用了 mysql_connect 但没有指定参数。如果不能创建连接，则产生一个 E_WARNING 级别的错误。

***返回值***

成功返回结果集指针 resource，失败返回FALSE，使用函数  mysql_tablename 来遍历结果集指针，或者使用其它遍历结果集函数，如  mysql_fetch_array.

***例子***

**Example 22.60. mysql_list_dbs example**

```php

<?php
// Usage without mysql_list_dbs()
$link = mysql_connect('localhost', 'mysql_user', 'mysql_password');
$res = mysql_query("SHOW DATABASES");

while ($row = mysql_fetch_assoc($res)) {
    echo $row['Database'] . "\n";
}

// Deprecated as of PHP 5.4.0
$link = mysql_connect('localhost', 'mysql_user', 'mysql_password');
$db_list = mysql_list_dbs($link);

while ($row = mysql_fetch_object($db_list)) {
     echo $row->Database . "\n";
}
?>

```

上述例子可能的输出类似于：

```
database1
database2
database3
```

***注意事项***

>**注意**    
>为了向后兼容，已弃用函数别名 mysql_listdbs 可以使用

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_db_name
            </td>
        </tr>
		<tr>
            <td>
				mysql_select_db
            </td>
        </tr>
    </tbody>
</table>

###### 22.9.2.5.33. mysql_list_fields

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_list_fields

列出MySQL表字段

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				SQL Query: SHOW COLUMNS FROM sometable
            </td>
        </tr>
    </tbody>
</table>

***描述***

`resource mysql_list_fields(string database_name,string table_name,resource link_identifier= =NULL)`

获取指定表的信息

该函数已经弃用了，最好使用函数 mysql_query 来执行一个 `SHOW COLUMNS FROM table [LIKE 'name']` 语句来代替。

***参数***

*database_name*

要执行查询的数据库的名字

*table_name*

要执行查询的表的名字

*link_identifier*

MySQL连接标识符，如果没有指定， 则使用由 mysql_connect 创建的最后一个连接，如果不存在，则试图创建一个连接，就好像调用了 mysql_connect 但没有指定参数。如果不能创建连接，则产生一个 E_WARNING 级别的错误。

***返回值***

成功返回结果集指针resource，失败返回FALSE

返回结果可以用于函数  mysql_field_flags, mysql_field_len, mysql_field_name 和 mysql_field_type.

***例子***

**Example 22.61. Alternate to deprecated mysql_list_fields**

```php

<?php
$result = mysql_query("SHOW COLUMNS FROM sometable");
if (!$result) {
    echo 'Could not run query: ' . mysql_error();
    exit;
}
if (mysql_num_rows($result) > 0) {
    while ($row = mysql_fetch_assoc($result)) {
        print_r($row);
    }
}
?>

```

上面例子的输出将类似于：

```
Array
(
    [Field] => id
    [Type] => int(7)
    [Null] =>  
    [Key] => PRI
    [Default] =>
    [Extra] => auto_increment
)
Array
(
    [Field] => email
    [Type] => varchar(100)
    [Null] =>
    [Key] =>
    [Default] =>
    [Extra] =>
)
```

***注意事项***

>**注意**    
>为了向后兼容，已弃用别名  mysql_listfields 可以使用

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_field_flags
            </td>
        </tr>
		<tr>
            <td>
				mysql_info
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.34. mysql_list_processes

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_list_processes

列出MySQL进程

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_thread_id
            </td>
        </tr>
    </tbody>
</table>

***描述***

`resource mysql_list_processes(resource link_identifier= =NULL)`

获取当前MySQL服务器线程

***参数***

*link_identifier*

MySQL连接标识符，如果没有指定， 则使用由 mysql_connect 创建的最后一个连接，如果不存在，则试图创建一个连接，就好像调用了 mysql_connect 但没有指定参数。如果不能创建连接，则产生一个 E_WARNING 级别的错误。

***返回值***

成功返回结果集指针resource，失败返回FALSE

***例子***

**Example 22.62. mysql_list_processes example**

```php

<?php
$link = mysql_connect('localhost', 'mysql_user', 'mysql_password');

$result = mysql_list_processes($link);
while ($row = mysql_fetch_assoc($result)){
    printf("%s %s %s %s %s\n", $row["Id"], $row["Host"], $row["db"],
        $row["Command"], $row["Time"]);
}
mysql_free_result($result);
?>

```

上面列子的输出类似于：

```
1 localhost test Processlist 0
4 localhost mysql sleep 5
```

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_thread_id
            </td>
        </tr>
		<tr>
            <td>
				mysql_stat
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.35. mysql_list_tables

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_list_tables

列出MySQL数据库中的表

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				SQL Query: SHOW TABLES FROM sometable
            </td>
        </tr>
    </tbody>
</table>

***描述***

`resource mysql_list_tables(string database,resource link_identifier= =NULL)`

获取一个MySQL数据库中所有表名

该函数已经弃用了，最好使用 mysql_query 来执行 `SHOW TABLES [FROM db_name] [LIKE 'pattern']` 语句来替代。

***参数***

*database*

数据库的名字

*link_identifier*

MySQL连接标识符，如果没有指定， 则使用由 mysql_connect 创建的最后一个连接，如果不存在，则试图创建一个连接，就好像调用了 mysql_connect 但没有指定参数。如果不能创建连接，则产生一个 E_WARNING 级别的错误。

***返回值***

成功返回一个指向结果集指针resource，失败返回FALSE

使用函数  mysql_tablename 来遍历结果集指针，获取其它遍历结果的函数，例如 mysql_fetch_array.

***变更日志***

<table summary="Changelog information for this function" border="0">
    <thead>
        <tr>
            <th scope="col">
                Version
            </th>
            <th scope="col">
                Description
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td scope="row">
                4.3.7
            </td>
            <td>
                该函数开始弃用了
            </td>
        </tr>
    </tbody>
</table>

***例子***

**Example 22.63. mysql_list_tables alternative example**

```php

<?php
$dbname = 'mysql_dbname';

if (!mysql_connect('mysql_host', 'mysql_user', 'mysql_password')) {
    echo 'Could not connect to mysql';
    exit;
}

$sql = "SHOW TABLES FROM $dbname";
$result = mysql_query($sql);

if (!$result) {
    echo "DB Error, could not list tables\n";
    echo 'MySQL Error: ' . mysql_error();
    exit;
}

while ($row = mysql_fetch_row($result)) {
    echo "Table: {$row[0]}\n";
}

mysql_free_result($result);
?>

```

***注意事项***

>注意    
>为了向后兼容，已弃用别名 mysql_listtables 可以使用

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_list_dbs
            </td>
        </tr>
		<tr>
            <td>
				mysql_tablename
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.36. mysql_num_fields

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_num_fields

获取结果集中字段的数量

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_field_count
            </td>
        </tr>
		<tr>
            <td>
				mysqli_field_count
            </td>
        </tr>
    </tbody>
</table>

***描述***

`int mysql_num_fields(resource result)`

获取结果集中字段的数量

***参数***

*result*

结果集resource，结果集来自对 mysql_query 的调用

***返回值***

成功返回结果集的字段数，失败返回FALSE

***例子***

**Example 22.64. A mysql_num_fields example**

```php

<?php
$result = mysql_query("SELECT id,email FROM people WHERE id = '42'");
if (!$result) {
    echo 'Could not run query: ' . mysql_error();
    exit;
}

/* returns 2 because id,email === two fields */
echo mysql_num_fields($result);
?>

```

***注意事项***

>注意    
>为了向后兼容，已弃用函数别名 mysql_numfields 可以使用

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_select_db
            </td>
        </tr>
		<tr>
            <td>
				mysql_query
            </td>
        </tr>
		 <tr>
            <td>
				mysql_fetch_field
            </td>
        </tr>
		<tr>
            <td>
				mysql_num_rows
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.37. mysql_num_rows

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_num_rows

获取结果集行数

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_stmt_num_rows
            </td>
        </tr>
		<tr>
            <td>
				PDOStatement::rowCount
            </td>
        </tr>
    </tbody>
</table>

***描述***

`int mysql_num_rows(resource result)`

获取结果集的行数，该函数仅对像 SELECT 或者 SHOW 语句有效因为它们返回一个结果集，如果想获取 INSERT, UPDATE, REPLACE 或者 DELETE 操作所影响的函数，则调用函数 mysql_affected_rows.

***参数***

*result*

结果集resource，结果集来自对 mysql_query 的调用

***返回值***

成功返回结果集的行数，失败返回FALSE

***例子***

**Example 22.65. mysql_num_rows example**

```php

<?php

$link = mysql_connect("localhost", "mysql_user", "mysql_password");
mysql_select_db("database", $link);

$result = mysql_query("SELECT * FROM table1", $link);
$num_rows = mysql_num_rows($result);

echo "$num_rows Rows\n";

?>

```

***注意事项***

>**注意**    
>如果使用  mysql_unbuffered_query 函数，则 mysql_num_rows 直到获取了结果集中所有的row后才返回正确的值

>**注意**      
>为了向后兼容，已弃用别名 mysql_numrows 可以使用

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_affected_rows
            </td>
        </tr>
		<tr>
            <td>
				mysql_connect
            </td>
        </tr>
		 <tr>
            <td>
				mysql_data_seek
            </td>
        </tr>
		<tr>
            <td>
				mysql_select_db
            </td>
        </tr>
		<tr>
            <td>
				mysql_query
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.38. mysql_pconnect

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_pconnect

创建到MySQL服务器的持久连接

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_connect with p: host prefix
            </td>
        </tr>
		<tr>
            <td>
				PDO::__construct with PDO::ATTR_PERSISTENT as a driver option
            </td>
        </tr>
    </tbody>
</table>

***描述***

```
resource mysql_pconnect(string server= =ini_get("mysql.default_host"),
                        string username= =ini_get("mysql.default_user"),
                        string password= =ini_get("mysql.default_password"),
                        int client_flags= =0);

```

建立到MySQL服务器的持久连接

mysql_pconnect 类似于 mysql_connect，但是又两个主要的区别：

一，当创建连接的时候，该函数首选试图查找使用相同主机、相同用户名、相同密码的已建立的持久连接，如果找到了，则返回它的标识符而不是建立一个新的连接。

二，当脚本执行结束后，到服务器的连接不会关闭，相反，连接仍然保持已建立状态以备之后使用( mysql_close 不能关闭由 mysql_pconnect 建立的连接)。

因此这种连接被称为持久连接

***参数***

*server*

MySQL服务器，也可以包含端口号，例如 'hostname:port' ，或者是本地socket路径，如 ':/path/to/socket'。

如果PHP指令 mysql.default_host 没有定义(默认)，则默认的值是 'localhost:3306'.

*username*

用户名，默认的是拥有服务器进程的用户名

*password*

密码，默认密码为空

*client_flags*

参数 client_flags 可以使如下常量的组合：128 (可以使用 LOAD DATA LOCAL), MYSQL_CLIENT_SSL , MYSQL_CLIENT_COMPRESS , MYSQL_CLIENT_IGNORE_SPACE 或者 MYSQL_CLIENT_INTERACTIVE .

***返回值***

成功返回MySQL持久连接标识符，失败返回FALSE

***变更日志***

<table summary="Changelog information for this function" border="0">
    <thead>
        <tr>
            <th scope="col">
                Version
            </th>
            <th scope="col">
                Description
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td scope="row">
                5.5.0
            </td>
            <td>
               该函数生成一个 E_DEPRECATED 级别的错误
            </td>
        </tr>
        <tr>
            <td scope="row">
                4.3.0
            </td>
            <td>
                增加 *client_flags* 参数
            </td>
        </tr>
    </tbody>
</table>

***注意事项***

>**注意**    
>注意，该类型的连接仅适用于将PHP作为模块使用，更多信息详见 [数据库持久连接](http://cn2.php.net/manual/en/features.persistent-connections.php)

>**警告**     
>使用持久连接需要 Apache于MySQL配置的协调，已确保没有超过MySQL允许的最大连接数

>**注意**    
>通过在函数名前加符合 [@](http://cn2.php.net/manual/en/language.operators.errorcontrol.php) 来抑制错误信息的输出

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_connect
            </td>
        </tr>
		<tr>
            <td>
				Persistent Database Connections
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.39. mysql_ping

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_ping

ping服务器连接，或者没有连接的话重新创建连接

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_ping
            </td>
        </tr>
    </tbody>
</table>

***描述***

`bool mysql_ping(resource link_identifier= =NULL)`

检测到服务器的连接是否仍然正常，如果已经断开连接了，则尝试自动重新连接，该函数可以被idle很长时间的脚本使用，检测服务器是否已经关闭了连接以及如果需要的话重新建立连接。

>**注意**    
>在MySQL版本大于5.0.3中，自动重新连接默认是disable的

***参数***

*link_identifier*

MySQL连接标识符，如果没有指定， 则使用由 mysql_connect 创建的最后一个连接，如果不存在，则试图创建一个连接，就好像调用了 mysql_connect 但没有指定参数。如果不能创建连接，则产生一个 E_WARNING 级别的错误。

***返回值***

如果到MySQL服务器的连接仍然正常则返回TRUE，否则返回FALSE。

***例子***

Example 22.66. A mysql_ping example

```php

<?php
set_time_limit(0);

$conn = mysql_connect('localhost', 'mysqluser', 'mypass');
$db   = mysql_select_db('mydb');

/* Assuming this query will take a long time */
$result = mysql_query($sql);
if (!$result) {
    echo 'Query #1 failed, exiting.';
    exit;
}

/* Make sure the connection is still alive, if not, try to reconnect */
if (!mysql_ping($conn)) {
    echo 'Lost connection, exiting after query #1';
    exit;
}
mysql_free_result($result);

/* So the connection is still alive, let's run another query */
$result2 = mysql_query($sql2);
?>

```

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_thread_id
            </td>
        </tr>
		<tr>
            <td>
				mysql_list_processes
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.40. mysql_query

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_query

发送一个MySQL查询

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_query
            </td>
        </tr>
		<tr>
            <td>
				PDO::query
            </td>
        </tr>
    </tbody>
</table>

***描述***

`resource mysql_query(string query,resource link_identifier= =NULL)`

mysql_query 向与指定连接标识符 *link_identifier* 关联的服务器 当前的数据库发送一个查询(多查询不支持) 。

***参数***

*query*

一个SQL查询

查询字符串不用以分号结束，查询中涉及到的数据要适当的转义

*link_identifier*

MySQL连接标识符，如果没有指定， 则使用由 mysql_connect 创建的最后一个连接，如果不存在，则试图创建一个连接，就好像调用了 mysql_connect 但没有指定参数。如果不能创建连接，则产生一个 E_WARNING 级别的错误。

***返回值***

对于 SELECT, SHOW, DESCRIBE, EXPLAIN等其他返回结果集的语句，mysql_query 返回一个资源标识符resource，如果失败返回FALSE。

对于其它的SQL语句，例如UPDATE, DELETE, DROP等等，mysql_query 执行成功返回TRUE，失败返回FALSE。

返回的结果集资源标识符应该传递给函数 mysql_fetch_array ，或者其它的函数来处理结果集，访问返回的数据。

函数 mysql_num_rows 可以查看 SELECT 操作返回了多少行； 函数 mysql_affected_rows  可以查看 DELETE, INSERT, REPLACE, 或者 UPDATE 操作影响了多少行。

如果用户没有权限访问查询中用到的表，则 mysql_query 执行失败并返回FALSE。

***例子***

**Example 22.67. Invalid Query**

下面的查询在语法上是不合法的，因此 mysql_query 执行失败并返回FALSE

```php
<?php
$result = mysql_query('SELECT * WHERE 1=1');
if (!$result) {
    die('Invalid query: ' . mysql_error());
}

?>

```

**Example 22.68. Valid Query**

下面的查询是合法的，因此 mysql_query 返回一个resource

```php

<?php
// This could be supplied by a user, for example
$firstname = 'fred';
$lastname  = 'fox';

// Formulate Query
// This is the best way to perform an SQL query
// For more examples, see mysql_real_escape_string()
$query = sprintf("SELECT firstname, lastname, address, age FROM friends 
    WHERE firstname='%s' AND lastname='%s'",
    mysql_real_escape_string($firstname),
    mysql_real_escape_string($lastname));

// Perform Query
$result = mysql_query($query);

// Check result
// This shows the actual query sent to MySQL, and the error. Useful for debugging.
if (!$result) {
    $message  = 'Invalid query: ' . mysql_error() . "\n";
    $message .= 'Whole query: ' . $query;
    die($message);
}

// Use result
// Attempting to print $result won't allow access to information in the resource
// One of the mysql result functions must be used
// See also mysql_result(), mysql_fetch_array(), mysql_fetch_row(), etc.
while ($row = mysql_fetch_assoc($result)) {
    echo $row['firstname'];
    echo $row['lastname'];
    echo $row['address'];
    echo $row['age'];
}

// Free the resources associated with the result set
// This is done automatically at the end of the script
mysql_free_result($result);
?>

```

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_connect
            </td>
        </tr>
		<tr>
            <td>
				mysql_error
            </td>
        </tr>
		<tr>
            <td>
				mysql_real_escape_string
            </td>
        </tr>
		<tr>
            <td>
				mysql_result
            </td>
        </tr>
		<tr>
            <td>
				mysql_fetch_assoc
            </td>
        </tr>
		<tr>
            <td>
				mysql_unbuffered_query
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.41. mysql_real_escape_string

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_real_escape_string

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_real_escape_string
            </td>
        </tr>
		<tr>
            <td>
				PDO::quote
            </td>
        </tr>
    </tbody>
</table>

***描述***

`string mysql_real_escape_string(string unescaped_string, resource link_identifier= =NULL)`

转义 *unescaped_string* 中的特殊字符，考虑当前连接的字符集设置以使将它放在一个 mysql_query 里是安全的，如果想插入二进制数据的话，该函数必须使用。

mysql_real_escape_string 调用 MySQL库函数 mysql_real_escape_string，在字符  \x00, \n, \r, \, ', " 和 \x1a 前添加反斜杆。

该函数必须经常(极少意外)使用，以使将查询发送到MySQL之前数据是安全的。

>**安全问题:默认字符集**       
>字符集必须设置，或者通过服务器层，或者通过API函数 mysql_set_charset 来影响 mysql_real_escape_string，更多信息查看 [字符集][22.09.01.05.02]

***参数***

*unescaped_string*

将要转义的字符串

*link_identifier*

MySQL连接标识符，如果没有指定， 则使用由 mysql_connect 创建的最后一个连接，如果不存在，则试图创建一个连接，就好像调用了 mysql_connect 但没有指定参数。如果不能创建连接，则产生一个 E_WARNING 级别的错误。

***返回值***

成功返回转义后的字符串，失败返回FALSE

***例子***

**Example 22.69. Simple mysql_real_escape_string example**

```php

<?php
// Connect
$link = mysql_connect('mysql_host', 'mysql_user', 'mysql_password')
    OR die(mysql_error());

// Query
$query = sprintf("SELECT * FROM users WHERE user='%s' AND password='%s'",
            mysql_real_escape_string($user),
            mysql_real_escape_string($password));
?>

```

**Example 22.70. An example SQL Injection Attack**

```php

<?php
// We didn't check $_POST['password'], it could be anything the user wanted! For example:
$_POST['username'] = 'aidan';
$_POST['password'] = "' OR ''='";

// Query database to check if there are any matching users
$query = "SELECT * FROM users WHERE user='{$_POST['username']}' AND password='{$_POST['password']}'";
mysql_query($query);

// This means the query sent to MySQL would be:
echo $query;
?>

```

发送到MySQL的查询：

```
SELECT * FROM users WHERE user='aidan' AND password='' OR ''=''
```

这将导致任何人不用密码就可以登录。

***注意事项***

>**注意**     
>在使用函数 mysql_real_escape_string 之前需要有MySQL连接，否则会生成 E_WARNING 级别的错误并返回FALSE；如果没有指定 *link_identifier* ，则使用最后的一次MySQL连接

>**注意**     
>如果开启了 [magic_quotes_gpc](http://www.php.net/manual/en/ini.core.php#ini.magic-quotes-gpc)，则首先会对数据应用函数 [stripslashes](http://cn2.php.net/stripslashes)，如果再使用该函数，则会对已转义的字符转义两次。

>**注意**     
>如果没有使用该函数转义字符，则查询很容易受到 [SQL注入攻击](http://cn2.php.net/manual/en/security.database.sql-injection.php)

>**注意**    
>mysql_real_escape_string 不转义  % 和 _，这些如果和 LIKE, GRANT, 或者 REVOKE 一起使用的话是通配符。

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_set_charset
            </td>
        </tr>
		<tr>
            <td>
				mysql_client_encoding
            </td>
        </tr>
		<tr>
            <td>
				addslashes
            </td>
        </tr>
		<tr>
            <td>
				stripslashes
            </td>
        </tr>
		<tr>
            <td>
				The magic_quotes_gpc directive
            </td>
        </tr>
		<tr>
            <td>
				The magic_quotes_runtime directive
            </td>
        </tr>
    </tbody>
</table>
 
##### 22.9.2.5.42. mysql_result

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_result

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_data_seek in conjunction with mysqli_field_seek and mysqli_fetch_field
            </td>
        </tr>
		<tr>
            <td>
				PDOStatement::fetchColumn
            </td>
        </tr>
    </tbody>
</table>

***描述***

`string mysql_result(resource result, int row,mixed field= =0)`

从MySQL结果集中获取一cell数据

当结果集很大的时候，你应该考虑使用获取整个行的函数，因为这些函数在一次调用中返回多个cell，它们比 mysql_result 快很多。同时需要注意的是，对于 field 参数，指定数值偏移量比指定字段名或 tablename.fieldname 快很多。

***参数***

*result*

结果集资源标识符resource，来自于对 mysql_query 的调用

*row*

想要获取的结果集行号，行号从0开始

*field*

想要获取的列名或者列偏移量

它既可以使列偏移量，也可以是列名，或者是列所在表.列名(tablename.fieldname)，如果给列名指定了别名(`select foo as bar from..`)，则使用别名来代替列名，如果没有定义列，则取得第一列。

***返回值***

成功返回MySQL结果集的一个cell的内容，失败返回FALSE

***例子***

**Example 22.71. mysql_result example**

```php

<?php
$link = mysql_connect('localhost', 'mysql_user', 'mysql_password');
if (!$link) {
    die('Could not connect: ' . mysql_error());
}
if (!mysql_select_db('database_name')) {
    die('Could not select database: ' . mysql_error());
}
$result = mysql_query('SELECT name FROM work.employee');
if (!$result) {
    die('Could not query:' . mysql_error());
}
echo mysql_result($result, 2); // outputs third employee's name

mysql_close($link);
?>

```

***注意事项***

>**注意**     
>调用函数 mysql_result 就不能其他处理结果集的函数混合调用

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_fetch_row
            </td>
        </tr>
		<tr>
            <td>
				mysql_fetch_array
            </td>
        </tr>
		<tr>
            <td>
				mysql_fetch_assoc
            </td>
        </tr>
		<tr>
            <td>
				mysql_fetch_object
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.43. mysql_select_db

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_select_db

选择一个MySQL数据库

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_select_db
            </td>
        </tr>
		<tr>
            <td>
				PDO::__construct (part of dsn)
            </td>
        </tr>
    </tbody>
</table>

***描述***

`bool mysql_select_db(string database_name, resource link_identifier= =NULL)`

设置连接标识符关联的服务器上当前active的数据库，接下来的 mysql_query 将会作用于这个active的数据库。

***参数***

*database_name*

选取的数据库的名字

*link_identifier*

MySQL连接标识符，如果没有指定， 则使用由 mysql_connect 创建的最后一个连接，如果不存在，则试图创建一个连接，就好像调用了 mysql_connect 但没有指定参数。如果不能创建连接，则产生一个 E_WARNING 级别的错误。

***返回值***

成功返回TREU，失败返回FALSE

***例子***

Example 22.72. mysql_select_db example

```php

<?php

$link = mysql_connect('localhost', 'mysql_user', 'mysql_password');
if (!$link) {
    die('Not connected : ' . mysql_error());
}

// make foo the current db
$db_selected = mysql_select_db('foo', $link);
if (!$db_selected) {
    die ('Can\'t use foo : ' . mysql_error());
}
?>

```

***注意事项***

>**注意**     
>为了向后兼容，已弃用别名  mysql_selectdb 可以使用

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_connect
            </td>
        </tr>
		<tr>
            <td>
				mysql_pconnect
            </td>
        </tr>
		<tr>
            <td>
				mysql_query
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.44. mysql_set_charset

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_set_charset

设置客户端字符集

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_character_set_name
            </td>
        </tr>
		<tr>
            <td>
				PDO: Add charset to the connection string, such as charset=utf8
            </td>
        </tr>
    </tbody>
</table>

***描述***

`bool mysql_set_charset(string charset,resource link_identifier= =NULL)`

设置当前连接的默认字符集

***参数***

*charset*

有效字符集名称

*link_identifier*

MySQL连接标识符，如果没有指定， 则使用由 mysql_connect 创建的最后一个连接，如果不存在，则试图创建一个连接，就好像调用了 mysql_connect 但没有指定参数。如果不能创建连接，则产生一个 E_WARNING 级别的错误。

***返回值***

成功返回TRUE，失败返回FALSE

***注意事项***

>**注意**    
>该函数要求MySQL5.0.7及以后版本


>**注意**      
>这是比较好的改变字符集的方法，不推荐使用 mysql_query(例如 `SET NAMES utf8`)来设置，更多信息参见[MySQL 字符集设置][22.09.01.05.02]


***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_client_encoding
            </td>
        </tr>
		<tr>
            <td>
				Setting character sets in MySQL
            </td>
        </tr>
		<tr>
            <td>
				List of character sets that MySQL supports
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.45. mysql_stat

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_stat

获取当前系统状态

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_stat
            </td>
        </tr>
		<tr>
            <td>
				PDO::getAttribute(PDO::ATTR_SERVER_INFO)
            </td>
        </tr>
    </tbody>
</table>

***描述***

`string mysql_stat(resource link_identifier= =NULL)`

mysql_stat 返回当前系统状态

***参数***

*link_identifier*

MySQL连接标识符，如果没有指定， 则使用由 mysql_connect 创建的最后一个连接，如果不存在，则试图创建一个连接，就好像调用了 mysql_connect 但没有指定参数。如果不能创建连接，则产生一个 E_WARNING 级别的错误。

***返回值***

返回一个字符串，包含 uptime, threads, queries, open tables, flush tables 和 queries per second信息，如果想获取完整的status变量列表，必须使用  `SHOW STATUS` SQL命令，如果 *link_identifier* 不是合法的，则返回NULL

***例子***

**Example 22.73. mysql_stat example**

```php

<?php
$link   = mysql_connect('localhost', 'mysql_user', 'mysql_password');
$status = explode('  ', mysql_stat($link));
print_r($status);
?>

```

上面例子的输出类似于：

```
Array
(
    [0] => Uptime: 5380
    [1] => Threads: 2
    [2] => Questions: 1321299
    [3] => Slow queries: 0
    [4] => Opens: 26
    [5] => Flush tables: 1
    [6] => Open tables: 17
    [7] => Queries per second avg: 245.595
)
```

**Example 22.74. Alternative mysql_stat example**

```php

<?php
$link   = mysql_connect('localhost', 'mysql_user', 'mysql_password');
$result = mysql_query('SHOW STATUS', $link);
while ($row = mysql_fetch_assoc($result)) {
    echo $row['Variable_name'] . ' = ' . $row['Value'] . "\n";
}
?>

```

上面列子的输出类似于：

```
back_log = 50
basedir = /usr/local/
bdb_cache_size = 8388600
bdb_log_buffer_size = 32768
bdb_home = /var/db/mysql/
bdb_max_lock = 10000
bdb_logdir =
bdb_shared_data = OFF
bdb_tmpdir = /var/tmp/
...
```

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_get_server_info
            </td>
        </tr>
		<tr>
            <td>
				mysql_list_processes
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.46. mysql_tablename

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_tablename

获取表名

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				SQL Query: SHOW TABLES
            </td>
        </tr>
    </tbody>
</table>

***描述***

`string mysql_tablename(resource result,int i)`

从 *result* 中获取表名

该函数已经弃用了，最好使用 mysql_query 来执行一个 `SHOW TABLES [FROM db_name] [LIKE 'pattern']` 语句来代替。

***参数***

*result*

结果集标识符resource，来自于 mysql_list_tables 调用的返回

*i*

整数索引(行/表序号)

***返回值***

成功返回表名，失败返回FALSE

使用函数 mysql_tablename 来遍历结果集指针，或者其它任何遍历结果集的函数，如 mysql_fetch_array.

***变更日志***

<table summary="Changelog information for this function" border="0">
    <thead>
        <tr>
            <th scope="col">
                Version
            </th>
            <th scope="col">
                Description
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td scope="row">
                5.5.0
            </td>
            <td>
                函数 mysql_tablename 已经弃用了，生成 E_DEPRECATED 级别的错误
            </td>
        </tr>
    </tbody>
</table>

***例子***

**Example 22.75. mysql_tablename example**

```php

<?php
mysql_connect("localhost", "mysql_user", "mysql_password");
$result = mysql_list_tables("mydb");
$num_rows = mysql_num_rows($result);
for ($i = 0; $i < $num_rows; $i++) {
    echo "Table: ", mysql_tablename($result, $i), "\n";
}

mysql_free_result($result);
?>

```

***注意事项***

>**注意**    
>函数 mysql_num_rows 可以获取结果集指针对应的表的数量

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_list_tables
            </td>
        </tr>
		<tr>
            <td>
				mysql_field_table
            </td>
        </tr>
		<tr>
            <td>
				mysql_db_name
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.47. mysql_thread_id

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_thread_id

返回当前线程ID

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				mysqli_thread_id
            </td>
        </tr>
    </tbody>
</table>

***描述***

`int mysql_thread_id(resource link_identifier= =NULL)`

获取当前线程ID，如果连接已经丢失了，则会使用函数 mysql_ping 来重新建立连接，线程ID会变化，这意味着当需要时获取的是当前的线程ID。

***参数***

*link_identifier*

MySQL连接标识符，如果没有指定， 则使用由 mysql_connect 创建的最后一个连接，如果不存在，则试图创建一个连接，就好像调用了 mysql_connect 但没有指定参数。如果不能创建连接，则产生一个 E_WARNING 级别的错误。

***返回值***

成功返回线程ID，失败返回FALSE

***例子***

**Example 22.76. mysql_thread_id example**

```php

<?php
$link = mysql_connect('localhost', 'mysql_user', 'mysql_password');
$thread_id = mysql_thread_id($link);
if ($thread_id){
    printf("current thread id is %d\n", $thread_id);
}
?>

```

上面例子的输出类似于：

```
current thread id is 73
```

***参考***

<table border="0">
    <tbody>
        <tr>
            <td>
				mysql_ping
            </td>
        </tr>
		<tr>
            <td>
				mysql_list_processes
            </td>
        </tr>
    </tbody>
</table>

##### 22.9.2.5.48. mysql_unbuffered_query

<a href="#3407">Copyright 1997-2012 the PHP Documentation Group.</a>

* mysql_unbuffered_query

发送SQL查询语句到MySQL服务器，但是不获取及缓存结果集

>**警告**
>该扩展从PHP 5.5.0 开始废弃了并且以后会被移除，代之以使用扩展 [MySQLi][22.09.03] 或者 [PDO_MySQL][22.09.04]，更多信息详见 [MySQL: 选择一个API][#22.09.01.03] 和 [related FAQ](http://cn2.php.net/manual-lookup.php?pattern=faq.databases.mysql.deprecated&lang=en&scope=404quickref)。该行数的替代函数包括：    
><table border="0" summary="Simple list">
    <tbody>
        <tr>
            <td>
				See: Buffered and Unbuffered queries
            </td>
        </tr>
    </tbody>
</table>

***描述***

`resource mysql_unbuffered_query(string query, resource link_identifier= =NULL)`

mysql_unbuffered_query 发送SQL查询 *query* 到服务器，但是不像 mysql_query 一样自动获取及缓存结果集，这样对于产生大结果集的SQL查询来讲会节省相当大的内存，第一行返回之后就可以处理结果集，因为不需要等待整个SQL查询执行完毕。当有多个已打开的数据库连接时，则必须制定参数 *link_identifier* 来标志你想使用的连接。

***参数***

*query*

将要执行的SQL查询

查询中用到的数据必须适当转义

*link_identifier*

MySQL连接标识符，如果没有指定， 则使用由 mysql_connect 创建的最后一个连接，如果不存在，则试图创建一个连接，就好像调用了 mysql_connect 但没有指定参数。如果不能创建连接，则产生一个 E_WARNING 级别的错误。

***返回值***

 对于 SELECT, SHOW, DESCRIBE 或者 EXPLAIN 语句，mysql_unbuffered_query 成功则返回一个resource标识符，失败返回FALSE。
 
 对于其它类型的SQL语句，如 UPDATE, DELETE, DROP等，mysql_unbuffered_query  成功则返回TREU，失败返回FALSE。
 
 ***注意事项***
 
 >**注意**     
 >mysql_unbuffered_query 的益处是有代价的：在所有的行返回之前，不可以对 mysql_unbuffered_query 返回的结果集使用函数  mysql_num_rows 和 mysql_data_seek，在获取所有的行之前也不可以使用相同的 *link_identifier* 来发送新的SQL语句到MySQL服务器。
 
 ***参考***
 
 <table border="0">
    <tbody>
        <tr>
            <td>
				mysql_query
            </td>
        </tr>
    </tbody>
</table>



[22.09.01.03]:./22.09.01_Overview_of_the_MySQL_PHP_drivers.md#22.09.01.03
[22.09.01.05.02]:./22.09.01_Overview_of_the_MySQL_PHP_drivers.md#22.09.01.05
[22.09.03]:./22.09.03_MySQL_Improved_Extension_Mysqli.md
[22.09.04]:./22.09.04_MySQL_Functions_PDO_MYSQL_MySQL_PDO.md
[22.09.05.01]:./22.09.05_MySQL_Native_Driver_Mysqlnd.md#22.9.5.1
[22.09.02.03]:./#22.9.2.3
