### 11.3.6 时间值小数秒

在MySQL5.6.4之前，实例是被限制的，其中在时间值中小数秒是允许的。在上下文中尾部的小数秒是允许的，如文字值和一些时间函数的参数或返回值。例如：

```
mysql> SELECT MICROSECOND('2010-12-10 14:12:09.019473');
+-------------------------------------------+
| MICROSECOND('2010-12-10 14:12:09.019473') |
+-------------------------------------------+
| 19473                                     |
+-------------------------------------------+
```

但是，当MySQL将值存储到任何时间类型的列中时，它会丢弃小数部分并且不会存储它们。

MySQL5.6.4和更高版本扩展了对TIME，DATETIME和TIMESTAMP的小数秒的支持，达到微妙（6位）精度：

* 定义一个包含小数秒的列，使用语法 *type\_name(fsp)* ，其中 *type\_name* 是TIME，DATETIME，或TIMESTAMP，和 *fsp* 是小数秒的精度。例如：

```
CREATE TABLE t1 (t TIME(3), dt DATETIME(6));
```

 *fsp* 的值，如果给定，必须在范围0到6之间。0表示没有小数秒部分。如果省略，默认值精度是0。（与以前MySQL版本的兼容性上，这里不同于标准的SQL默认值6。）

* 函数采用可以可以接受的小数秒值作为参数。时间函数的返回值包含恰当的小数秒。例如，NOW()[1240]没有参数，返回没有小数秒的当前日期和时间，但有一个包含许多位数的小数部分的从0到6的可选参数。

* 时间写法产生时间值的语法：DATE 'str'，TIME 'str'和TIMESTAMP 'str'，和ODBC语法等效。如果指定，结果值包含尾部小数秒部分。以前，时间类型关键字被忽略并且这些结构产生字符串值。参见[标准SQL和ODBC日期与时间写法](http://xxx)。

在某些情况下，以前接受的语法可能会产生不同的结果。下面列项目表明，现有的代码也许需要修改以避免出现这些问题：

* 有些表达式产生的结果与以前的结果不同。例如，timestamp系统变量的返回值包含微妙小数秒部分而不是一个整数。包含当前时间解释 *fsp* 值作为参数具有返回值的函数（如CURTIME()[1233]，SYSDATE()[1243]，或UTC_TIMESTAMP()[1247]），并且返回值包含许多位数的小数秒部分。以前，这些函数允许参数，但忽略它们。

* TIME值通过添加时间到当前日期才可转换到DATETIME。（意思是，如果时间值超出范围'00:00:00'到'23:59:59'，那么结果的日期部分不同于当前日期。）以前，TIME值向DATETIME转换时不可靠的。参见[11.3.7节，“日期和时间类型之间的转换”][11.03.07]。

* TIMESTAMP( *N* )在MySQL的旧版本中是允许的，但是 *N* 是显示宽度，而不是小数秒的精度。支持的这种特性已在MySQL5.5.3中删除。所以合理的应用程序不应受制于这个问题。否则，必须重写代码。


[11.03.07]: 11.03.07_Conversion_Between_Date_and_Time_Types.md